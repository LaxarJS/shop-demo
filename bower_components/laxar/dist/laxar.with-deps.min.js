/** Copyright 2015 aixigo AG, Released under the MIT license: http://laxarjs.org/license */
define("laxar/lib/logging/console_channel",[],function(){"use strict";function a(a){var d=window.console;if(d){var e=a.level.toLowerCase();if(e in d&&"trace"!==e||(e="log"),e in d){var f=[a.level+": "];f=f.concat(c(a.text,a.replacements)),f.push("(@ "+a.sourceInfo.file+":"+a.sourceInfo.line+")"),b(d,e,f)}}}function b(a,b,c){Function.apply.apply(a[b],[a,c])}function c(a,b){for(var c,d=0,e="",f=[];d<a.length;){switch(c=a.charAt(d)){case"\\":if(++d,d===a.length)throw new Error('Unterminated string: "'+a+'"');e+=a.charAt(d);break;case"[":f.push(e),e="";var g=a.indexOf("]",d);if(-1===g)throw new Error("Unterminated replacement at character "+d+': "'+a+'"');var h=parseInt(a.substring(d+1,g),10);f.push(b[h]),d=g;break;default:e+=c}++d}return e.length>0&&f.push(e),f}return a}),define("laxar/lib/utilities/assert",[],function(){"use strict";function a(a,b){this.subject_=a,this.details_=b||null}function b(a,b){throw b&&(a+=" Details: "+("object"==typeof b?JSON.stringify(b):b)),new Error("Assertion error: "+a)}function c(a,b){if("object"==typeof a)return a instanceof b;var c=f[typeof a];return c===b}function d(a){var b=g.exec(a.toString().trim());return b[1].length?b[1]:"n/a"}function e(b,c){return new a(b,c)}a.prototype.isNotNull=function(a){return("undefined"==typeof this.subject_||null===this.subject_)&&b("Expected value to be defined and not null.",a||this.details_),this},a.prototype.hasType=function(a,e){if("undefined"==typeof this.subject_||null===this.subject_)return this;if("function"!=typeof a&&b("type must be a constructor function. Got "+typeof a+"."),!c(this.subject_,a)){var f=d(this.subject_.constructor),g=d(a);b('Expected value to be an instance of "'+g+'" but was "'+f+'".',e||this.details_)}return this},a.prototype.hasProperty=function(a,c){return"object"!=typeof this.subject_&&b("value must be an object. Got "+typeof this.subject_+"."),a in this.subject_||b('value is missing mandatory property "'+a+'".',c||this.details_),this};var f={string:String,number:Number,"boolean":Boolean,"function":Function},g=/^function ([^\(]*)\(/i;return e.codeIsUnreachable=function(a){b("Code should be unreachable!",a)},e.state=function(a,c){a||b("State does not hold.",c)},e}),define("laxar/lib/utilities/object",[],function(){"use strict";function a(a,b){return i(k.call(arguments,0),function(a,b,c){a[c]=b[c]})}function b(b,c){return a({},c,b)}function c(a,b){if(Array.isArray(a))return void a.forEach(b);for(var c in a)j(a,c)&&b(a[c],c,a)}function d(a,b,c){for(var d=3===arguments.length?c:void 0,e=b.split("."),f=a,g=e.shift();g;){if(!f||"object"!=typeof f||!j(f,g))return d;f=f[g],g=e.shift()}return f}function e(a,b,c){var d=a,e=b.split("."),f=e.pop();return e.forEach(function(a,b){if(!d[a]||"object"!=typeof d[a]){var c=e[b+1]||f;c.match(/^[0-9]+$/)?(d[a]=[],h(d[a],parseInt(c,10))):d[a]={}}d=d[a]}),Array.isArray(d)&&f>d.length&&h(d,f),d[f]=c,a}function f(a){if(!a||"object"!=typeof a)return a;var b;if(Array.isArray(a)){b=[];for(var c=0,d=a.length;d>c;++c)b[c]=f(a[c])}else{b={};for(var e in a)j(a,e)&&(b[e]=f(a[e]))}return b}function g(a,b){return Object.isFrozen(a)?a:(b&&c(a,function(b,c){"object"==typeof b&&(a[c]=g(b,!0))}),Object.freeze(a))}function h(a,b){for(var c=a.length;b>c;++c)a[c]=null}function i(a,b){var c=a[0];return a.slice(1).forEach(function(a){if(a)for(var d in a)j(a,d)&&b(c,a,d)}),c}function j(a,b){return l.call(a,b)}var k=Array.prototype.slice,l=Object.prototype.hasOwnProperty;return{extend:a,options:b,forEach:c,path:d,setPath:e,deepClone:f,deepFreeze:"function"==typeof Object.freeze?g:function(a){return a}}}),define("laxar/lib/utilities/configuration",["./object"],function(a){"use strict";var b=new Function("return this")();return{get:function(c,d){return a.path(b.laxar,c,d)}}}),define("laxar/lib/logging/log",["./console_channel","../utilities/assert","../utilities/object","../utilities/configuration"],function(a,b,c,d){"use strict";function e(){this.queueSize_=100,this.channels_=[a],this.counter_=0,this.messageQueue_=[],this.threshold_=0,this.tags_={},this.level=c.options(d.get("logging.levels",{}),h),this.levelToName_=function(a,b){var d={};return c.forEach(b,function(b,c){a[c.toLowerCase()]=function(){var a=[b].concat(g.call(arguments,0));return this.log.apply(this,a)},d[b]=c}),d}(this,this.level),this.setLogThreshold(d.get("logging.threshold","INFO"))}function f(){var a=new Error;if(!a.stack)return k;var b,c=a.stack.split(/[\n]/);if("Error"===c[0])c.splice(0,1),b=function(a){var b=i.exec(a);return{file:b?b[1]:"?",line:b?b[2]:-1,"char":b?b[3]:-1}};else{if(-1===c[0].indexOf("@"))return k;b=function(a){var b=j.exec(a);return{file:b?b[1]:"?",line:b?b[2]:-1,"char":-1}}}for(var d=0;d<c.length;++d){var e=b(c[d]);if(-1===e.file.indexOf("/logging/log.js"))return e}return k}var g=Array.prototype.slice,h={TRACE:100,DEBUG:200,INFO:300,WARN:400,ERROR:500,FATAL:600};e.prototype.create=function(){return new e},e.prototype.log=function(a,b,c){if(!(a<this.threshold_)){var d={id:this.counter_++,level:this.levelToName_[a],text:b,replacements:g.call(arguments,2)||[],time:new Date,tags:this.gatherTags(),sourceInfo:f()};this.channels_.forEach(function(a){a(d)}),this.messageQueue_.length===this.queueSize_&&this.messageQueue_.shift(),this.messageQueue_.push(d)}},e.prototype.trace=function(){},e.prototype.debug=function(){},e.prototype.info=function(){},e.prototype.warn=function(){},e.prototype.error=function(){},e.prototype.fatal=function(){},e.prototype.addLogChannel=function(a){this.channels_.push(a),this.messageQueue_.forEach(function(b){a(b)})},e.prototype.removeLogChannel=function(a){var b=this.channels_.indexOf(a);b>-1&&this.channels_.splice(b,1)},e.prototype.addTag=function(a,c){b(a).hasType(String).isNotNull(),this.tags_[a]?this.tags_[a].push(c):this.tags_[a]=[c]},e.prototype.setTag=function(a,c){b(a).hasType(String).isNotNull(),this.tags_[a]=[c]},e.prototype.removeTag=function(a){b(a).hasType(String).isNotNull(),delete this.tags_[a]},e.prototype.gatherTags=function(){var a={};return c.forEach(this.tags_,function(b,c){a[c]=b.join(";")}),a},e.prototype.setLogThreshold=function(a){"string"==typeof a&&(b.state(a.toUpperCase()in this.level,'Unsupported log threshold "'+a+'".'),a=this.level[a.toUpperCase()]),b(a).hasType(Number),this.threshold_=a};var i=/\(?([^\( ]+\.js)\:(\d+)\:(\d+)\)?$/,j=/@(.+)\:(\d+)$/,k={file:"?",line:-1,"char":-1};return new e}),define("laxar/lib/directives/id/id",["angular","../../utilities/assert"],function(a,b){"use strict";var c=a.module("axId",[]),d="axId";c.directive(d,[function(){return{restrict:"A",link:function(a,c,e){var f=a.$eval(e[d]);b.state(f,"directive axId needs a non-empty local id, e.g. ax-id=\"'myLocalId'\"."),c.attr("id",a.id(f))}}}]);var e="axFor";return c.directive(e,[function(){return{restrict:"A",link:function(a,c,d){var f=a.$eval(d[e]);b.state(f,"directive axFor needs a non-empty local id, e.g. ax-for=\"'myLocalId'\"."),c.attr("for",a.id(f))}}}]),c}),define("laxar/lib/directives/layout/layout",["angular","../../logging/log"],function(a,b){"use strict";var c=a.module("axLayout",[]),d="axLayout";return c.directive(d,["axLayoutLoader","$compile",function(a,c){return{restrict:"A",link:function(e,f,g){var h=e.$eval(g[d]);a.load(h).then(function(a){f.html(a.htmlContent),f.addClass(a.className),c(f.contents())(e),e.$emit("axLayoutLoaded",h)},function(a){b.error("axLayout: could not load layout [0], error: [1]",h,a)})}}}]),c}),define("laxar/lib/utilities/string",[],function(){"use strict";function a(a,b,c){return e(a,b,c)}function b(a,b){function e(b,d,e){if("string"!=typeof b)return c(a)(b);var i=Array.isArray(d)?d:[],k={};e?k=e||{}:Array.isArray(d)||(k=d||{});for(var l=b.split(""),m="",n=0,o=l.length;o>n;++n)if(l[n]===f){if(n+1===o)throw new Error("Unterminated escaping sequence at index "+n+' of string: "'+b+'".');m+=l[++n]}else if(l[n]===g){var p=b.indexOf(h,n+1);if(-1===p)throw new Error("Unterminated placeholder at index "+n+' of string: "'+b+'".');var q=b.substring(n+1,p);m+=j(q,k,i,{string:b,index:n}),n=p}else m+=l[n];return m}function j(d,e,f,j){var k,l="",m="",n=d.split(":"),o=n[0];if(i.test(o)&&o<f.length)k=f[o];else{if(!(o in e))return g+d+h;k=e[o]}return n.length>1?("%"!==n[1].charAt(0)&&(k=c(a)(k)),n.slice(1).reduce(function(c,d){if(0===d.indexOf("%")){var e=d.match(/^%(.*)(\w)$/);if(l=e?e[2]:"",m=e?e[1]:"",l in a)return a[l](c,m);var f=Object.keys(a).filter(function(a){return"default"!==a}).map(function(a){return"%"+a}).join(", ");throw new Error('Unknown format specifier "%'+l+'" for placeholder at index '+j.index+' of string: "'+j.string+'" (Known specifiers are: '+f+").")}return d in b?b[d](c):c},k)):c(a)(k)}return a||(a=d),b||(b={}),e}function c(a){return"default"in a?a["default"]:d["default"]}var d={s:function(a){return""+a},d:function(a){return a.toFixed(0)},i:function(a,b){return d.d(a,b)},f:function(a,b){var c=b.match(/^\.(\d)$/);return c?a.toFixed(c[1]):""+a},o:function(a){return JSON.stringify(a)},"default":function(a,b){return d.s(a,b)}};"function"==typeof Object.freeze&&Object.freeze(d);var e=b(d),f="\\",g="[",h="]",i=/^[0-9]+$/;return{format:a,createFormatter:b,DEFAULT_FORMATTERS:d}}),define("laxar/lib/directives/widget_area/widget_area",["angular","../../utilities/string"],function(a,b){"use strict";var c=a.module("axWidgetArea",[]),d="axWidgetArea";return c.directive(d,["axPageService",function(a){return{restrict:"A",link:function(c,e,f){var g=c.widget&&c.widget.id,h=f[d];if(!h){if(!f[d+"Binding"]){var i="axWidgetArea: area at at [0] has neither a name nor a binding assigned.",j=g||c.layoutClass;throw new Error(b.format(i,[j]))}h=c.$eval(f[d+"Binding"])}g&&(h=g+"."+h);var k=a.controllerForScope(c).areas,l=k.register(h,e[0]);c.$on("$destroy",l)}}}]),c}),define("laxar/lib/directives/directives",["./id/id","./layout/layout","./widget_area/widget_area"],function(a,b,c,d){"use strict";return{id:a,layout:b,widgetArea:c,pageFade:d}}),define("laxar/lib/event_bus/event_bus",["../utilities/assert","../utilities/object","../logging/log"],function(a,b,c){"use strict";function d(a){this.config_=b.options(a,{pendingDidTimeout:12e4}),this.cycleCounter_=0,this.eventQueue_=[],this.subscriberTree_={},this.waitingDeferreds_=[],this.currentCycle_=-1,this.errorHandler_=m,this.mediator_=n(),this.inspectors_=[]}function e(a,b,c,d){if(0===c.length&&Array.isArray(b[s]))for(var f=b[s],g=f.length-1;g>=0;--g)f[g].subscriber===d&&(l(a,{action:"unsubscribe",source:f[g].subscriberName,target:"-",event:f[g].name,cycleId:a.currentCycle_}),f.splice(g,1));var h=c.shift();""===h&&(h=r),h in b&&e(a,b[h],c,d)}function f(a,b){0===a.eventQueue_.length&&p(function(){var b=a.eventQueue_;a.eventQueue_=[],h(a,g(a,b))}),a.eventQueue_.push(b)}function g(a,c){return a.mediator_(c).map(function(c){var d=c.meta;a.currentCycle_=d.cycleId;var e=i(a,d.name);if(0===e.length)return a.currentCycle_=-1,c.publishedDeferred;var f=null;e.length>1&&(f=JSON.stringify(c.event));var g=d.sender,h=d.options;return e.forEach(function(e){var i=e.subscriberName;if(h.deliverToSender||!g||g!==i){try{var j;j=e.options.clone?f?JSON.parse(f):c.event:b.deepFreeze(c.event,!0),e.subscriber(j,b.options(d,{unsubscribe:function(){a.unsubscribe(e.subscriber)}}))}catch(k){var m='error while calling subscriber "'+i+'" for event '+d.name+' published by "'+g+'" (subscribed to: '+e.name+")";a.errorHandler_(m,{Exception:k,"Published event":c.event,"Event meta information":d,"Caused by Subscriber":e})}l(a,{action:"deliver",source:g,target:i,event:d.name,eventObject:c.event,subscribedTo:e.name,cycleId:d.cycleId})}}),a.currentCycle_=-1,c.publishedDeferred})}function h(a,b){var c=a.waitingDeferreds_;a.waitingDeferreds_=b,c.forEach(function(a){a.resolve()}),0===a.eventQueue_.length&&(b.forEach(function(a){a.resolve()}),a.waitingDeferreds_=[])}function i(a,b){var c=[],d=b.split(u),e=a.subscriberTree_;return j(e,d,c),c.sort(function(a,b){var c=a.subscriptionWeight,d=b.subscriptionWeight;return c[0]===d[0]?d[1]-c[1]:d[0]-c[0]}),c}function j(a,b,c){if(Array.isArray(a[s])&&c.push.apply(c,a[s]),0!==b.length){var d=b[0];if(b=b.slice(1),-1!==d.indexOf(v)){var e=d.length;do d=d.substring(0,e),d in a&&j(a[d],b,c),e=d.lastIndexOf(v);while(-1!==e)}else d in a&&j(a[d],b,c);r in a&&j(a[r],b,c)}}function k(a){var b=a.split(u),c=[0,0];return b.forEach(function(a){a.length>0&&(c[0]++,c[1]+=a.split(v).length-1)}),c}function l(a,b){a.inspectors_.forEach(function(a){a(b)})}function m(a,b){if(window.console&&window.console.log){var c=window.console,d=c.error?"error":"log";c[d](a),b&&Object.keys(b).forEach(function(a){var e=b[a];c[d]("   - %s: %o",a,e),e instanceof Error&&e.stack&&c[d]("   - Stacktrace: %s",e.stack)})}}function n(a,b){return"function"==typeof a?a:b||function(a){return a}}var o,p,q,r="*",s=".",t="ax__events",u=".",v="-",w=/^([^.])([^.]*)Request(\..+)?$/;return d.prototype.setErrorHandler=function(a){this.errorHandler_=n(a,m)},d.prototype.setMediator=function(a){this.mediator_=n(a)},d.prototype.addInspector=function(b){return a(b).hasType(Function).isNotNull(),this.inspectors_.push(b),function(){var a=this.inspectors_.indexOf(b);-1!==a&&this.inspectors_.splice(a,1)}.bind(this)},d.prototype.subscribe=function(c,d,e){a(c).hasType(String).isNotNull(),a(d).hasType(Function).isNotNull();for(var f=b.options(e,{subscriber:null,clone:!0}),g={name:c,subscriber:d,subscriberName:f.subscriber,subscriptionWeight:k(c),options:f},h=c.split(u),i=this.subscriberTree_,j=0;j<h.length;++j){var m=h[j].length?h[j]:r;m in i||(i[m]={}),i=i[m]}s in i||(i[s]=[]),i[s].push(g),d.hasOwnProperty(t)||(d[t]=[]),d[t].push(c),l(this,{action:"subscribe",source:f.subscriber,target:"-",event:c,cycleId:this.currentCycle_})},d.prototype.unsubscribe=function(b){if(a(b).hasType(Function).isNotNull(),b.hasOwnProperty(t)&&Array.isArray(b[t])){var c=this,d=this.subscriberTree_;b[t].forEach(function(a){e(c,d,a.split(u),b)}),delete b[t]}},d.prototype.publish=function(d,e,g){a(d).hasType(String).isNotNull();var h=JSON.parse(JSON.stringify(e||{})),i=b.options(g,{deliverToSender:!0,sender:h.sender||null});h.sender&&c.warn("Deprecation warning: The event sender should be set in the options, not the event itself.\nSender: [0], Eventname: [1]",h.sender,d);var j={meta:{name:d,cycleId:this.currentCycle_>-1?this.currentCycle_:this.cycleCounter_++,sender:i.sender,initiator:null,options:i},event:h,publishedDeferred:o.defer()};return f(this,j),l(this,{action:"publish",source:i.sender,target:"-",event:d,eventObject:h,cycleId:j.meta.cycleId}),j.publishedDeferred.promise},d.prototype.publishAndGatherReplies=function(c,d,e){function f(b,c){a(c.sender).hasType(String).isNotNull("A response with will to a request-event must contain a sender."),n.push(c.sender)}function g(a,b){p.push({event:a,meta:b});var c=n.indexOf(b.sender);-1!==c&&n.splice(c,1),0===n.length&&r&&h()}function h(a){clearTimeout(s),j.unsubscribe(f),j.unsubscribe(g),(a?m.reject:m.resolve)(p)}a(c).hasType(String).isNotNull();var i=w.exec(c);a.state(!!i,'Expected eventName to end with "Request" but got '+c);var j=this,k=b.options(e,{pendingDidTimeout:this.config_.pendingDidTimeout}),l=i[1].toUpperCase()+i[2];i[3]&&(l+=i[3]);var m=o.defer(),n=[],p=[],r=!1;this.subscribe("will"+l,f,{subscriber:k.sender}),this.subscribe("did"+l,g,{subscriber:k.sender});var s=q(function(){if(n.length>0){var a="Timeout while waiting for pending did"+l+" on "+c+".";j.errorHandler_(a,{Sender:k.sender,"After ms timeout":k.pendingDidTimeout,"Responses missing from":n.join(", ")}),h(!0)}},k.pendingDidTimeout);return this.publish(c,d,k).then(function(){return 0===n.length?void h():void(r=!0)}),m.promise},{create:function(b){return a(o).isNotNull("Need a promise implementation like $q or Q"),a(p).hasType(Function).isNotNull("Need a next tick implementation like $timeout"),a(q).hasType(Function).isNotNull("Need a timeout implementation like $timeout or setTimeout"),new d(b)},init:function(a,b,c){o=a,p=b,q=c}}}),define("laxar/lib/utilities/path",["require","./assert"],function(a,b){"use strict";function c(){var a=Array.prototype.slice.call(arguments,0);if(0===a.length)return"";var c="";a=a.reduce(function(a,d){b(d).hasType(String).isNotNull();var e=k.exec(d);return e?(c=e[1],d=e[2],d.split(i)):a.concat(d.split(i))},[]);var d=h(a);return c+d.join(i)}function d(a){var b="",c=k.exec(a);c&&(b=c[1],a=c[2]);var d=h(a.split(i));return b+d.join(i)}function e(a,c){var d=k.exec(a),e=k.exec(c);b(d).isNotNull(),b(e).isNotNull();var f=h(d[2].split(i)),g=h(e[2].split(i));return f.reduce(function(a,b){return a[0]===b?a.shift():a.unshift(".."),a},g).join(i)||"."}function f(a,b,c){var e=g(a,c||"amd");if("function"!=typeof l[e.scheme])throw new Error('Unknown schema type "'+e.scheme+'" in reference "'+a+'".');return d(l[e.scheme](e.ref,b))}function g(a,b){var c=a.split(":");return{scheme:2===c.length?c[0]:b,ref:2===c.length?c[1]:c[0]}}function h(a){return a.reduce(function(a,b){return b=b.replace(/^\/+|\/+$/g,""),""===b||"."===b?a:0===a.length?[b]:b===j&&a.length>0&&a[a.length-1]!==j?(a.pop(),a):(a.push(b),a)},[])}var i="/",j="..",k=/^([a-z0-9]+:\/\/[^\/]+\/|\/)(.*)$/,l={local:function(a,b){return c(b,a)},amd:function(b){return a.toUrl(b)}};return{resolveAssetPath:f,extractScheme:g,join:c,normalize:d,relative:e}}),define("laxar/lib/file_resource_provider/file_resource_provider",["../utilities/assert","../utilities/string","../utilities/path","../utilities/configuration"],function(a,b,c,d){"use strict";function e(a){this.useEmbedded_=d.get("useEmbeddedFileListings",!1),this.rootPath_=c.normalize(a),this.fileListings_={},this.fileListingUris_={},this.httpGets_={},this.httpHeads_={},this.httpHeadCache_={}}function f(a,b){function c(a,b,c){for(var d=b.replace(a.rootPath_,"").replace(m,"").split("/"),e=0,f=d.length;f>e;++e){if(e===f-1){var g=c[d[e]];return a.useEmbedded_?"string"==typeof g?g:g===n:"string"==typeof g||g===n}if(c=c[d[e]],"object"!=typeof c)return!1}}var d=Object.keys(a.fileListingUris_).filter(function(a){return 0===b.indexOf(a)});if(d.length){var e=d[0];return h(a,e).then(function(d){return k.when(c(a,b,d))})}return k.reject()}function g(a){return/\.json$/.test(a)?function(a){return JSON.parse(a)}:function(a){return a}}function h(a,b){if(a.fileListings_[b])return k.when(a.fileListings_[b]);var c=a.fileListingUris_[b];return i(a,c).then(g(c)).then(function(c){return a.fileListings_[b]=c,c})}function i(a,b){if(b in a.httpGets_)return a.httpGets_[b];var c=a.httpGets_[b]=l.get(b,{transformResponse:[]}).then(function(a){return k.when(a.data)});return c.then(function(){delete a.httpGets_[b]}),c}function j(a,b){if(b in a.httpHeadCache_)return k.when(a.httpHeadCache_[b]);if(b in a.httpHeads_)return a.httpHeads_[b];var c=a.httpHeads_[b]=l.head(b).then(function(){return!0},function(){return!1});return c.then(function(c){a.httpHeadCache_[b]=c,delete a.httpHeads_[b]}),c}var k,l,m=/^\/|\/$/g,n=1;return e.prototype.provide=function(a){var b=this;return f(this,a).then(function(c){return"string"==typeof c?k.when(c).then(g(a)):c!==!1?i(b,a).then(g(a)):k.reject()},function(){return i(b,a).then(g(a))})},e.prototype.isAvailable=function(a){var b=this;return f(b,a).then(function(a){return k.when(a!==!1)},function(){return j(b,a).then(function(a){return k.when(a)})})},e.prototype.setFileListingUri=function(a,b){var d=c.join(this.rootPath_,a);this.fileListingUris_[d]=c.join(this.rootPath_,b),this.fileListings_[d]=null,h(this,d)},e.prototype.setFileListingContents=function(a,b){var d=c.join(this.rootPath_,a);this.fileListingUris_[d]="#",this.fileListings_[d]=b},{create:function(b){return a(k).isNotNull("Need a promise implementation like $q or Q"),a(l).isNotNull("Need a http client implementation like $http"),new e(b)},init:function(a,b){k=a,l=b}}}),define("laxar/lib/i18n/i18n",["../utilities/string","../utilities/assert","../utilities/configuration"],function(a,b,c){"use strict";function d(a,c,d){if(b(a).hasType(String),!c||k[typeof c])return c;b(a).isNotNull();var e=c[a];if(void 0!==e)return e;for(var f=l(a),g=n(c),h=g.length,i=0;h>i;++i){var j=g[i];if(l(j)===f)return c[j]}return d}function e(a,e,f){if(b(a).hasType(String),!e||k[typeof e])return e;for(var g=a?a.replace(/-/g,"_").split("_"):[];g.length>0;){var h=g.join("-"),j=d(h,e);if(void 0!==j)return j;g.pop()}return void 0===i&&(i=c.get("i18n.fallback","en")),i&&d(i,e)||f}function f(a,b){function c(c){return j(a,c,b)}return c.format=function(c,d,e){var f=j(a,c);return void 0===f?b:m(f,d,e)},c}function g(a,b){return a&&a.hasOwnProperty("tags")?a.tags[a.locale]||b:b}function h(a){var b={};return function(c){var d=b[c];return void 0===d&&(d=a(c),b[c]=d),d}}var i,j=e,k={string:!0,number:!0,"boolean":!0},l=h(function(a){return a.toLowerCase().replace(/[-]/g,"_")}),m=a.format,n=Object.keys;return{localize:j,localizeStrict:d,localizeRelaxed:e,localizer:f,languageTagFromI18n:g}}),define("laxar/lib/loaders/paths",["require"],function(a){"use strict";return{PRODUCT:a.toUrl("laxar-path-root"),THEMES:a.toUrl("laxar-path-themes"),LAYOUTS:a.toUrl("laxar-path-layouts"),CONTROLS:a.toUrl("laxar-path-controls"),WIDGETS:a.toUrl("laxar-path-widgets"),PAGES:a.toUrl("laxar-path-pages"),FLOW_JSON:a.toUrl("laxar-path-flow"),DEFAULT_THEME:a.toUrl("laxar-path-default-theme")}}),function(){function a(){return this instanceof a?(this.coerceType={},this.fieldType=b(f),this.fieldValidate=b(h),this.fieldFormat=b(g),this.defaultOptions=b(m),void(this.schema={})):new a}var b=function(a){if(null===a||"object"!=typeof a)return a;var c;if(a instanceof Date)return c=new Date,c.setTime(a.getTime()),c;if(a instanceof RegExp)return c=new RegExp(a);if(a instanceof Array){c=[];for(var d=0,e=a.length;e>d;d++)c[d]=b(a[d]);return c}if(a instanceof Object){c={};for(var f in a)a.hasOwnProperty(f)&&(c[f]=b(a[f]));return c}throw new Error("Unable to clone object!")},c=function(a){for(var c=[b(a[0])],d=c[0].key,e=c[0].object,f=1,g=a.length;g>f;f++)e=e[d],d=a[f].key,c.push({object:e,key:d});return c},d=function(a,b){var c=a.length-1,d=a[c].key;b[c].object[d]=a[c].object[d]},e={type:!0,not:!0,anyOf:!0,allOf:!0,oneOf:!0,$ref:!0,$schema:!0,id:!0,exclusiveMaximum:!0,exclusiveMininum:!0,properties:!0,patternProperties:!0,additionalProperties:!0,items:!0,additionalItems:!0,required:!0,"default":!0,title:!0,description:!0,definitions:!0,dependencies:!0},f={"null":function(a){return null===a},string:function(a){return"string"==typeof a},"boolean":function(a){return"boolean"==typeof a},number:function(a){return"number"==typeof a&&a===a},integer:function(a){return"number"==typeof a&&a%1===0},object:function(a){return a&&"object"==typeof a&&!Array.isArray(a)},array:function(a){return Array.isArray(a)},date:function(a){return a instanceof Date}},g={alpha:function(a){return/^[a-zA-Z]+$/.test(a)},alphanumeric:function(a){return/^[a-zA-Z0-9]+$/.test(a)},identifier:function(a){return/^[-_a-zA-Z0-9]+$/.test(a)},hexadecimal:function(a){return/^[a-fA-F0-9]+$/.test(a)},numeric:function(a){return/^[0-9]+$/.test(a)},"date-time":function(a){return!isNaN(Date.parse(a))&&-1===a.indexOf("/")},uppercase:function(a){return a===a.toUpperCase()},lowercase:function(a){return a===a.toLowerCase()},hostname:function(a){return a.length<256&&/^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])(\.([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9]))*$/.test(a)},uri:function(a){return/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/.test(a)},email:function(a){return/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/.test(a)},ipv4:function(a){if(/^(\d?\d?\d)\.(\d?\d?\d)\.(\d?\d?\d)\.(\d?\d?\d)$/.test(a)){var b=a.split(".").sort();if(b[3]<=255)return!0}return!1},ipv6:function(a){return/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/.test(a)}},h={readOnly:function(a,b){return!1},minimum:function(a,b,c){return!(b>a||c.exclusiveMinimum&&b>=a)},maximum:function(a,b,c){return!(a>b||c.exclusiveMaximum&&a>=b)},multipleOf:function(a,b){return a/b%1===0||"number"!=typeof a},pattern:function(a,b){if("string"!=typeof a)return!0;var c,d;"string"==typeof b?c=b:(c=b[0],d=b[1]);var e=new RegExp(c,d);return e.test(a)},minLength:function(a,b){return a.length>=b||"string"!=typeof a},maxLength:function(a,b){return a.length<=b||"string"!=typeof a},minItems:function(a,b){return a.length>=b||!Array.isArray(a)},maxItems:function(a,b){return a.length<=b||!Array.isArray(a)},uniqueItems:function(a,b){for(var c,d={},e=0,f=a.length;f>e;e++){if(c=JSON.stringify(a[e]),d.hasOwnProperty(c))return!1;d[c]=!0}return!0},minProperties:function(a,b){if("object"!=typeof a)return!0;var c=0;for(var d in a)a.hasOwnProperty(d)&&(c+=1);return c>=b},maxProperties:function(a,b){if("object"!=typeof a)return!0;var c=0;for(var d in a)a.hasOwnProperty(d)&&(c+=1);return b>=c},constant:function(a,b){return JSON.stringify(a)==JSON.stringify(b)},"enum":function(a,b){var c,d,e;if("object"==typeof a){for(e=JSON.stringify(a),c=0,d=b.length;d>c;c++)if(e===JSON.stringify(b[c]))return!0}else for(c=0,d=b.length;d>c;c++)if(a===b[c])return!0;return!1}},i=function(a){return-1===a.indexOf("://")?a:a.split("#")[0]},j=function(a,b,c){var d,e,f,g;if(f=c.indexOf("#"),-1===f)return a.schema.hasOwnProperty(c)?[a.schema[c]]:null;if(f>0)if(g=c.substr(0,f),c=c.substr(f+1),a.schema.hasOwnProperty(g))b=[a.schema[g]];else{if(!b||b[0].id!==g)return null;b=[b[0]]}else{if(!b)return null;c=c.substr(1)}if(""===c)return[b[0]];if("/"===c.charAt(0)){for(c=c.substr(1),d=b[0],e=c.split("/");e.length>0;){if(!d.hasOwnProperty(e[0]))return null;d=d[e[0]],b.push(d),e.shift()}return b}return null},k=function(a,b){var c,d,e,f,g=a.length-1,h=/^(\d+)/.exec(b);if(h){if(b=b.substr(h[0].length),e=parseInt(h[1],10),0>e||e>g)return;if(f=a[g-e],"#"===b)return f.key}else f=a[0];if(d=f.object[f.key],""===b)return d;if("/"===b.charAt(0)){for(b=b.substr(1),c=b.split("/");c.length>0;){if(c[0]=c[0].replace(/~1/g,"/").replace(/~0/g,"~"),!d.hasOwnProperty(c[0]))return;d=d[c[0]],c.shift()}return d}},l=function(a,b,f,g){var h,i,m,n,o,p,q,r,s,t,u,v,w,x=!1,y={},z=b.length-1,A=b[z],B=f.length-1,C=f[B].object,D=f[B].key,E=C[D];if(A.hasOwnProperty("$ref"))return b=j(a,b,A.$ref),b?l(a,b,f,g):{$ref:A.$ref};if(A.hasOwnProperty("type"))if("string"==typeof A.type){if(g.useCoerce&&a.coerceType.hasOwnProperty(A.type)&&(E=C[D]=a.coerceType[A.type](E)),!a.fieldType[A.type](E))return{type:A.type}}else{for(x=!0,h=0,i=A.type.length;i>h&&x;h++)a.fieldType[A.type[h]](E)&&(x=!1);if(x)return{type:A.type}}if(A.hasOwnProperty("allOf"))for(h=0,i=A.allOf.length;i>h;h++)if(r=l(a,b.concat(A.allOf[h]),f,g))return r;if(g.useCoerce||g.useDefault||g.removeAdditional){if(A.hasOwnProperty("oneOf")){for(w=1/0,h=0,i=A.oneOf.length,m=0;i>h;h++)if(u=c(f),r=l(a,b.concat(A.oneOf[h]),u,g))v=r.schema?Object.keys(r.schema).length:1,w>v&&(w=v,y=r);else{if(m+=1,m>1)break;d(u,f)}if(m>1)return{oneOf:!0};if(1>m)return y;y={}}if(A.hasOwnProperty("anyOf")){for(y=null,w=1/0,h=0,i=A.anyOf.length;i>h;h++){if(u=c(f),r=l(a,b.concat(A.anyOf[h]),u,g),!r){d(u,f),y=null;break}v=r.schema?Object.keys(r.schema).length:1,w>v&&(w=v,y=r)}if(y)return y}if(A.hasOwnProperty("not")&&(u=c(f),r=l(a,b.concat(A.not),u,g),!r))return{not:!0}}else{if(A.hasOwnProperty("oneOf")){for(w=1/0,h=0,i=A.oneOf.length,m=0;i>h;h++)if(r=l(a,b.concat(A.oneOf[h]),f,g))v=r.schema?Object.keys(r.schema).length:1,w>v&&(w=v,y=r);else if(m+=1,m>1)break;if(m>1)return{oneOf:!0};if(1>m)return y;y={}}if(A.hasOwnProperty("anyOf")){for(y=null,w=1/0,h=0,i=A.anyOf.length;i>h;h++){if(r=l(a,b.concat(A.anyOf[h]),f,g),!r){y=null;break}v=r.schema?Object.keys(r.schema).length:1,w>v&&(w=v,y=r)}if(y)return y}if(A.hasOwnProperty("not")&&(r=l(a,b.concat(A.not),f,g),!r))return{not:!0}}if(A.hasOwnProperty("dependencies"))for(p in A.dependencies)if(A.dependencies.hasOwnProperty(p)&&E.hasOwnProperty(p))if(Array.isArray(A.dependencies[p])){for(h=0,i=A.dependencies[p].length;i>h;h++)if(!E.hasOwnProperty(A.dependencies[p][h]))return{dependencies:!0}}else if(r=l(a,b.concat(A.dependencies[p]),f,g))return r;if(Array.isArray(E)){if(A.hasOwnProperty("items"))if(Array.isArray(A.items)){for(h=0,i=A.items.length;i>h;h++)r=l(a,b.concat(A.items[h]),f.concat({object:E,key:h}),g),null!==r&&(y[h]=r,x=!0);if(E.length>i&&A.hasOwnProperty("additionalItems"))if("boolean"==typeof A.additionalItems){if(!A.additionalItems)return{additionalItems:!0}}else for(h=i,i=E.length;i>h;h++)r=l(a,b.concat(A.additionalItems),f.concat({object:E,key:h}),g),null!==r&&(y[h]=r,x=!0)}else for(h=0,i=E.length;i>h;h++)r=l(a,b.concat(A.items),f.concat({object:E,key:h}),g),null!==r&&(y[h]=r,x=!0);else if(A.hasOwnProperty("additionalItems")&&"boolean"!=typeof A.additionalItems)for(h=0,i=E.length;i>h;h++)r=l(a,b.concat(A.additionalItems),f.concat({object:E,key:h}),g),null!==r&&(y[h]=r,x=!0);if(x)return{schema:y}}else{s=[],y={};for(p in E)E.hasOwnProperty(p)&&s.push(p);if(g.checkRequired&&A.required)for(h=0,i=A.required.length;i>h;h++)E.hasOwnProperty(A.required[h])||(y[A.required[h]]={required:!0},x=!0);if(n=A.hasOwnProperty("properties"),o=A.hasOwnProperty("patternProperties"),n||o)for(h=s.length;h--;){if(t=!1,n&&A.properties.hasOwnProperty(s[h])&&(t=!0,r=l(a,b.concat(A.properties[s[h]]),f.concat({object:E,key:s[h]}),g),null!==r&&(y[s[h]]=r,x=!0)),o)for(p in A.patternProperties)A.patternProperties.hasOwnProperty(p)&&s[h].match(p)&&(t=!0,r=l(a,b.concat(A.patternProperties[p]),f.concat({object:E,key:s[h]}),g),null!==r&&(y[s[h]]=r,x=!0));t&&s.splice(h,1)}if(g.useDefault&&n&&!x)for(p in A.properties)A.properties.hasOwnProperty(p)&&!E.hasOwnProperty(p)&&A.properties[p].hasOwnProperty("default")&&(E[p]=A.properties[p]["default"]);if(g.removeAdditional&&n&&A.additionalProperties!==!0&&"object"!=typeof A.additionalProperties)for(h=0,i=s.length;i>h;h++)delete E[s[h]];else if(A.hasOwnProperty("additionalProperties"))if("boolean"==typeof A.additionalProperties){if(!A.additionalProperties)for(h=0,i=s.length;i>h;h++)y[s[h]]={additional:!0},x=!0}else for(h=0,i=s.length;i>h;h++)r=l(a,b.concat(A.additionalProperties),f.concat({object:E,key:s[h]}),g),null!==r&&(y[s[h]]=r,x=!0);if(x)return{schema:y}}for(q in A)A.hasOwnProperty(q)&&!e.hasOwnProperty(q)&&("format"===q?a.fieldFormat.hasOwnProperty(A[q])&&!a.fieldFormat[A[q]](E,A,f,g)&&(y[q]=!0,x=!0):a.fieldValidate.hasOwnProperty(q)&&!a.fieldValidate[q](E,A[q].hasOwnProperty("$data")?k(f,A[q].$data):A[q],A,f,g)&&(y[q]=!0,x=!0));return x?y:null},m={useDefault:!1,useCoerce:!1,checkRequired:!0,removeAdditional:!1};a.prototype={validate:function(a,b,c){var d=[a],e=null,f=[{object:{__root__:b},key:"__root__"}];if("string"==typeof a&&(d=j(this,null,a),!d))throw new Error("jjv: could not find schema '"+a+"'.");if(c)for(var g in this.defaultOptions)this.defaultOptions.hasOwnProperty(g)&&!c.hasOwnProperty(g)&&(c[g]=this.defaultOptions[g]);else c=this.defaultOptions;return e=l(this,d,f,c),e?{validation:e.hasOwnProperty("schema")?e.schema:e}:null},resolveRef:function(a,b){return j(this,a,b)},addType:function(a,b){this.fieldType[a]=b},addTypeCoercion:function(a,b){this.coerceType[a]=b},addCheck:function(a,b){this.fieldValidate[a]=b},addFormat:function(a,b){this.fieldFormat[a]=b},addSchema:function(a,b){if(!b&&a&&(b=a,a=void 0),b.hasOwnProperty("id")&&"string"==typeof b.id&&b.id!==a){if("/"===b.id.charAt(0))throw new Error("jjv: schema id's starting with / are invalid.");this.schema[i(b.id)]=b}else if(!a)throw new Error("jjv: schema needs either a name or id attribute.");a&&(this.schema[i(a)]=b)}},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=a:"function"==typeof define&&define.amd?define("jjv",[],function(){return a}):this.jjv=a}.call(this),function(){"use strict";function a(d){var e=[],f=Object.keys(d.validation),g=f.every(function(a){return"object"!=typeof d.validation[a]||c(d.validation[a])});return g?f.forEach(function(a){var b,f;try{switch(a){
case"type":var g=typeof d.data;"number"===g&&(""+d.data).match(/^\d+$/)?g="integer":"object"===g&&Array.isArray(d.data)&&(g="array"),b={code:"INVALID_TYPE",message:"Invalid type: "+g+" should be "+(c(d.validation[a])?"one of ":"")+d.validation[a]};break;case"required":f=d.ns,b={code:"OBJECT_REQUIRED",message:"Missing required property: "+f[f.length-1]};break;case"minimum":b={code:"MINIMUM",message:"Value "+d.data+" is less than minimum "+d.schema.minimum};break;case"maximum":b={code:"MAXIMUM",message:"Value "+d.data+" is greater than maximum "+d.schema.maximum};break;case"multipleOf":b={code:"MULTIPLE_OF",message:"Value "+d.data+" is not a multiple of "+d.schema.multipleOf};break;case"pattern":b={code:"PATTERN",message:"String does not match pattern: "+d.schema.pattern};break;case"minLength":b={code:"MIN_LENGTH",message:"String is too short ("+d.data.length+" chars), minimum "+d.schema.minLength};break;case"maxLength":b={code:"MAX_LENGTH",message:"String is too long ("+d.data.length+" chars), maximum "+d.schema.maxLength};break;case"minItems":b={code:"ARRAY_LENGTH_SHORT",message:"Array is too short ("+d.data.length+"), minimum "+d.schema.minItems};break;case"maxItems":b={code:"ARRAY_LENGTH_LONG",message:"Array is too long ("+d.data.length+"), maximum "+d.schema.maxItems};break;case"uniqueItems":b={code:"ARRAY_UNIQUE",message:"Array items are not unique"};break;case"minProperties":b={code:"OBJECT_PROPERTIES_MINIMUM",message:"Too few properties defined ("+Object.keys(d.data).length+"), minimum "+d.schema.minProperties};break;case"maxProperties":b={code:"OBJECT_PROPERTIES_MAXIMUM",message:"Too many properties defined ("+Object.keys(d.data).length+"), maximum "+d.schema.maxProperties};break;case"enum":b={code:"ENUM_MISMATCH",message:"No enum match ("+d.data+"), expects: "+d.schema["enum"].join(", ")};break;case"not":b={code:"NOT_PASSED",message:'Data matches schema from "not"'};break;case"additional":f=d.ns,b={code:"ADDITIONAL_PROPERTIES",message:"Additional properties not allowed: "+f[f.length-1]};break;case"format":b={code:"FORMAT",message:"Value does not satisfy format: "+d.schema.format}}}catch(h){}if(!b){b={code:"FAILED",message:"Validation error: "+a};try{"boolean"!=typeof d.validation[a]&&(b.message=" ("+d.validation[a]+")")}catch(h){}}b.code="VALIDATION_"+b.code,void 0!==d.data&&(b.data=d.data),b.path=d.ns,e.push(b)}):f.forEach(function(c){var f;d.schema.$ref&&(d.schema.$ref.match(/#\/definitions\//)?d.schema=d.definitions[d.schema.$ref.slice(14)]:d.schema=d.schema.$ref,"string"==typeof d.schema&&(d.schema=d.env.resolveRef(null,d.schema),d.schema&&(d.schema=d.schema[0])),d.schema.type||(d.schema.type="object")),d.schema&&d.schema.type&&(b(d.schema,"object")&&(d.schema.properties&&d.schema.properties[c]&&(f=d.schema.properties[c]),!f&&d.schema.patternProperties&&Object.keys(d.schema.patternProperties).some(function(a){return c.match(new RegExp(a))?(f=d.schema.patternProperties[a],!0):void 0}),!f&&d.schema.hasOwnProperty("additionalProperties")&&(f="boolean"==typeof d.schema.additionalProperties?{}:d.schema.additionalProperties)),b(d.schema,"array")&&(f=d.schema.items));var g={env:d.env,schema:f||{},ns:d.ns.concat(c)};try{g.data=d.data[c]}catch(h){}try{g.validation=d.validation[c].schema?d.validation[c].schema:d.validation[c]}catch(h){g.validation={}}try{g.definitions=f.definitions||d.definitions}catch(h){g.definitions=d.definitions}e=e.concat(a(g))}),e}function b(a,b){return"string"==typeof a.type?a.type===b:c(a.type)?-1!==a.type.indexOf(b):!1}function c(a){return"function"==typeof Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a)}function d(a){var b=a.hasOwnProperty("root")?a.root:"$",c=a.hasOwnProperty("sep")?a.sep:".";return function(a){var d=b;return a.path.forEach(function(a){d+=a.match(/^\d+$/)?"["+a+"]":a.match(/^[A-Z_$][0-9A-Z_$]*$/i)?c+a:"["+JSON.stringify(a)+"]"}),a.path=d,a}}function e(b){return function(c,e,f,g){if(!f||!f.validation)return[];g=g||{},"string"==typeof c&&(c=b.schema[c]);var h=a({env:b,schema:c,data:e,validation:f.validation,ns:[],definitions:c.definitions||{}});return h.length&&g.formatPath!==!1?h.map(d(g)):h}}"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:"function"==typeof define&&define.amd?define("jjve",[],function(){return e}):this.jjve=e}.call(this),define("laxar/lib/json/schema",["../utilities/object"],function(a){"use strict";function b(c,e,f,g){var h={};if(Object.keys(c).forEach(function(i){var j=c[i];switch(i){case"required":if(j!==!0)break;!d(e,g)||"default"in c||("required"in f||(f.required=[]),f.required.push(e));break;case"items":h[i]=b(j,i,h,c);break;case"additionalProperties":"object"==typeof j?h[i]=b(j,i,h,c):h[i]=j;break;case"properties":case"patternProperties":h[i]={},a.forEach(j,function(a,d){h[i][d]=b(a,d,h,c)});break;default:h[i]=j}}),d(e,g)&&!c.required){var i=h.type;"string"==typeof i&&"null"!==i?h.type=[i,"null"]:Array.isArray(i)&&-1===i.indexOf("null")&&i.push("null")}return h}function c(a){!("properties"in a||"patternProperties"in a)||"additionalProperties"in a||(a.additionalProperties=!1),"properties"in a&&Object.keys(a.properties).forEach(function(b){c(a.properties[b])}),"additionalProperties"in a&&"object"==typeof a.additionalProperties&&c(a.additionalProperties),"patternProperties"in a&&Object.keys(a.patternProperties).forEach(function(b){c(a.patternProperties[b])}),"items"in a&&c(a.items)}function d(b,c){return c&&e(c,"object")&&a.path(c,"properties."+b)}function e(a,b){var c=a.type;return"string"==typeof c?c===b:Array.isArray(c)?-1!==c.indexOf(b):!0}return{transformV3ToV4:function(a){return b(a)},prohibitAdditionalProperties:function(a){c(a)}}}),define("laxar/lib/json/validator",["jjv","jjve","./schema","../utilities/object"],function(a,b,c,d){"use strict";function e(a,c,e,f){if(!a)return{errors:[]};var g=b(f);return{errors:g(c,e,a).map(function(a){return d.options({message:a.message+'. Path: "'+a.path+'".'},a)})}}var f="http://json-schema.org/draft-04/schema#";return{create:function(b,g){var h=a();g=d.options(g,{prohibitAdditionalProperties:!1}),h.defaultOptions=d.options(g,h.defaultOptions),"$schema"in b&&b.$schema===f||(b=c.transformV3ToV4(b),b.$schema=f,h.addType("any",function(a){return!0})),g.prohibitAdditionalProperties&&c.prohibitAdditionalProperties(b);var i=h.validate;return h.validate=function(a){var c=i.call(h,b,a);return e(c,b,a,h)},h},JSON_SCHEMA_V4_URI:f}}),define("laxar/lib/loaders/features_provider",["../json/validator","../utilities/object","../utilities/string"],function(a,b,c){"use strict";function d(a,c,d){if(!a.features)return{};var f=c.features||{},g=a.features;"$schema"in g||(g={$schema:"http://json-schema.org/draft-03/schema#",type:"object",properties:a.features}),b.forEach(g.properties,function(a,b){b in f||("object"===a.type?f[b]={}:"array"===a.type&&(f[b]=[]))});var h=e(g),i=h.validate(f);if(i.errors.length>0){var j="Validation for widget features failed. Errors: ";i.errors.forEach(function(a){j+="\n - "+a.message.replace(/\[/g,"\\[")}),d(j)}return f}function e(b){var c=a.create(b,{prohibitAdditionalProperties:!0,useDefault:!0});return c.addFormat("sub-topic",function(a){return"string"!=typeof a||g.test(a)}),c.addFormat("topic",function(a){return"string"!=typeof a||h.test(a)}),c.addFormat("flag-topic",function(a){return"string"!=typeof a||i.test(a)}),c.addFormat("language-tag",function(a){return"string"!=typeof a||j.test(a)}),c.addFormat("topic-map",function(a){return"object"!=typeof a||Object.keys(a).every(function(a){return h.test(a)})}),c.addFormat("localization",function(a){return"object"!=typeof a||Object.keys(a).every(function(a){return j.test(a)})}),c}var f="([a-z][+a-zA-Z0-9]*|[A-Z][+A-Z0-9]*)",g=new RegExp("^"+f+"$"),h=new RegExp("^("+f+"(-"+f+")*)$"),i=new RegExp("^[!]?("+f+"(-"+f+")*)$"),j=/^[a-z]{2,8}([-_][a-z0-9]{2,8})*([-_][a-z0-9][-_][a-z0-9]{2,8})*$/i;return{featuresForWidget:d}}),define("laxar/lib/widget_adapters/plain_adapter",[],function(){"use strict";function a(a){a.forEach(function(a){c[a.name]=a})}function b(a,b){function d(b){var d=c[j],e=g(),f=(d.injections||[]).map(function(a){return e.get(a)});b.onBeforeControllerCreation(a,e.get()),l=d.create.apply(d,f)}function e(b,c){null!==c&&(a.anchorElement.innerHTML=c,b.appendChild(a.anchorElement),l.renderTo(a.anchorElement))}function f(){var b=a.anchorElement.parentNode;b&&b.removeChild(a.anchorElement)}function g(){var a={axContext:k,axEventBus:k.eventBus,axFeatures:k.features||{}};return{get:function(c){if(0===arguments.length)return a;if(c in a)return a[c];if(c in b)return b[c];throw new Error('Unknown dependency "'+c+'".')}}}var h={createController:d,domAttachTo:e,domDetach:f,destroy:function(){}},i=a.specification.name,j=i.replace(/^./,function(a){return a.toLowerCase()}),k=a.context,l=null;return h}var c={};return{applyViewChanges:function(){},technology:"plain",bootstrap:a,create:b}}),define("laxar/lib/widget_adapters/angular_adapter",["angular","require","../utilities/assert","../logging/log"],function(a,b,c,d){"use strict";function e(b){var c=(b||[]).map(function(a){var b=h(a.name);return n[b]=g(a.name)+"Controller",i(a.name),a.name});return a.module("axAngularWidgetAdapter",c).run(["$compile","$controller","$rootScope",function(a,b,c){l=b,k=a,m=c}])}function f(b,c){function d(c){var d=h(b.specification.name),e=n[d];j={axContext:p,axEventBus:p.eventBus,axFeatures:p.features||{}},Object.defineProperty(j,"$scope",{enumerable:!0,get:function(){return i||(i=m.$new(),a.extend(i,p)),i}}),c.onBeforeControllerCreation(b,j),l(e,j)}function e(c,d){if(null!==d){var e=a.element(b.anchorElement);e.html(d),c.appendChild(b.anchorElement),k(b.anchorElement)(j.$scope),d=null}}function f(){var a=b.anchorElement.parentNode;a&&a.removeChild(b.anchorElement)}function g(){i&&i.$destroy()}var i,j,o={createController:d,domAttachTo:e,domDetach:f,destroy:g},p=b.context;return o}function g(a){return a.replace(/^./,function(a){return a.toUpperCase()})}function h(a){return a.replace(/([a-zA-Z0-9])[-_]([a-zA-Z0-9])/g,function(a,b,c){return b+c.toUpperCase()}).replace(/^[A-Z]/,function(a){return a.toLowerCase()})}function i(a){if(-1!==a.indexOf(".")){var b=a.replace(/^.*\.([^.]+)$/,function(a,b){return b.replace(/_(.)/g,function(a,b){return b.toUpperCase()})});n[b]=n[a]=a+".Controller",d.warn('Deprecation: AngularJS widget module name "'+a+'" violates naming rules! Module should be named "'+b+'". Controller should be named "'+g(b)+'Controller".')}}function j(){m.$apply()}var k,l,m,n={};return{applyViewChanges:j,technology:"angular",bootstrap:e,create:f}}),define("laxar/lib/widget_adapters/adapters",["./plain_adapter","./angular_adapter"],function(a,b){"use strict";var c={};return c[a.technology]=a,c[b.technology]=b,{getFor:function(a){return c[a]},getSupportedTechnologies:function(){return Object.keys(c)},addAdapters:function(a){a.forEach(function(a){c[a.technology]=a})}}}),define("laxar/lib/tooling/pages",["../utilities/object","../logging/log"],function(a,b){"use strict";function c(){var a=e.pageReference;["pageDefinitions","compositionDefinitions"].forEach(function(b){Object.keys(e[b]).filter(function(b){return b!==a}).forEach(function(a){delete e[b][a]})})}var d=!1,e={pageReference:null,pageDefinitions:{},compositionDefinitions:{},widgetDescriptors:{}},f=[];return{FLAT:"FLAT",COMPACT:"COMPACT",enable:function(){d=!0},disable:function(){d=!1,e.pageReference=null,e.widgetDescriptors={},c()},current:function(){return d||b.warn("laxar page tooling: trying to access data, but collecting it was never enabled"),a.deepClone(e)},addListener:function(a){d=!0,f.push(a)},removeListener:function(a){f=f.filter(function(b){return b!==a})},setWidgetDescriptor:function(a,b){d&&(e.widgetDescriptors[a]=b)},setPageDefinition:function(b,c,f){if(d){var g=e.pageDefinitions;g[b]=g[b]||{FLAT:null,COMPACT:null},g[b][f]=a.deepClone(c)}},setCompositionDefinition:function(b,c,f,g){if(d){var h=e.compositionDefinitions,i=h[b]=h[b]||{};i[c]=i[c]||{FLAT:null,COMPACT:null},i[c][g]=a.deepClone(f)}},setCurrentPage:function(b){d&&(e.pageReference=b,f.forEach(function(b){b(a.deepClone(e))}),c())}}}),define("laxar/lib/loaders/widget_loader",["../logging/log","../utilities/path","../utilities/assert","../utilities/object","../utilities/string","./paths","./features_provider","../widget_adapters/adapters","../tooling/pages"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(c,e){function j(j,x){var y=b.resolveAssetPath(j.widget,f.WIDGETS,"local"),A=b.join(y,"widget.json"),B=d.options(x,{onBeforeControllerCreation:function(){}});return w.provide(A).then(function(a){return c.all((a.controls||[]).map(v.load)).then(function(b){return b.forEach(k(a)),a})}).then(function(a){i.setWidgetDescriptor(j.widget,a);var b=d.options(a.integration,s),c=b.type,f=b.technology;c===r&&(c=p),c!==p&&c!==q&&m(j,"unknown integration type "+c);var k=m.bind(null,j),v=g.featuresForWidget(a,j,k),w=document.createElement("DIV");w.className=l(a.name),w.id="ax"+t+j.id;var x=o(z,a,j),A=h.getFor(f),C=A.create({anchorElement:w,context:{eventBus:x,features:v,id:n(j.id),widget:{area:j.area,id:j.id,path:j.widget}},specification:a},e);return C.createController(B),{id:j.id,adapter:C,destroy:function(){x.release(),C.destroy()},applyViewChanges:A.applyViewChanges||null,templatePromise:u(y,b,a,j)}},function(b){var c="Could not load spec for widget [0] from [1]: [2]";a.error(c,j.widget,A,b)})}function u(d,e,g,h){function i(){var a=g.name,e=a+".html",i=b.join("css/",a+".css"),k=d.split("/").pop(),l=k+".html",m=b.join("css/",k+".css"),n=b.extractScheme(h.widget).ref,o=[];return o.push(x.urlProvider(b.join(d,"[theme]"),b.join(f.THEMES,"[theme]","widgets",a),[b.join(f.THEMES,"[theme]","widgets",n)]).provide([e,i,l,m])),o=o.concat(j()),c.all(o).then(function(a){var b=a[0],c=a.slice(1).map(function(a){return a[0]}).concat(b[1]||b[3]).filter(function(a){return!!a});return{templateUrl:b[0]||b[2]||"",cssFileUrls:c}})}function j(){return(g.controls||[]).map(function(c){var d=v.descriptor(c),e=v.resolve(c),g=d.name,h=b.join(e,"[theme]"),i=b.join(f.THEMES,"[theme]","controls",g);return d._compatibility_0x&&(a.warn("Deprecation: Control is missing control.json descriptor: [0]",c),i=b.join(f.THEMES,"[theme]",c)),x.urlProvider(h,i).provide([b.join("css/",g+".css")])})}return e.type===q?c.when(null):i().then(function(a){return a.cssFileUrls.forEach(function(a){y.load(a)}),a.templateUrl?w.provide(a.templateUrl):null})}var v=e.axControls,w=e.axFileResourceProvider,x=e.axThemeManager,y=e.axCssLoader,z=e.axGlobalEventBus;return{load:j}}function k(b){return function(c){var d=(c.integration||s).technology;if("plain"!==d){var e=(b.integration||s).technology;e!==d&&a.warn("Incompatible integration technologies: widget [0] ([1]) cannot use control [2] ([3])",b.name,e,c.name,d)}}}function l(a){return a.replace(/([a-z0-9])([A-Z])/g,function(a,b,c){return b+"-"+c}).replace(/_/g,"-").toLowerCase()}function m(a,b){throw new Error(e.format('Error loading widget "[widget]" (id: "[id]"): [0]',[b],a))}function n(a){function b(a){return String.fromCharCode(c+a.charCodeAt(0)%26)}var c="a".charCodeAt(0),d="ax"+t+a.replace(u,b)+t;return function(a){return d+(""+a).replace(u,b)}}function o(a,b,c){function e(b){return function(){return a[b].apply(a,arguments)}}function f(a){return d.options(a,{sender:h})}function g(b){a.unsubscribe(b)}var h="widget."+b.name+"#"+c.id,i=[];return{addInspector:e("addInspector"),setErrorHandler:e("setErrorHandler"),setMediator:e("setMediator"),unsubscribe:g,subscribe:function(b,c,e){i.push(c);var f=d.options(e,{subscriber:h});a.subscribe(b,c,f)},publish:function(b,c,d){return a.publish(b,c,f(d))},publishAndGatherReplies:function(b,c,d){return a.publishAndGatherReplies(b,c,f(d))},release:function(){i.forEach(g)}}}var p="widget",q="activity",r="angular",s={type:p,technology:r},t="-",u=/[^A-Za-z0-9_\.-]/g;return{create:j}}),define("laxar/lib/utilities/fn",[],function(){"use strict";function a(a,b,c){var e,f,g,h=!1,i=function(){function i(l){var m=d._nowMilliseconds()-f;return l||m>=b?(e=null,void(c||h||(g=a.apply(j,k),e||(j=k=null)))):void(e=d._setTimeout(i,b-m))}var j=this,k=[].slice.call(arguments);f=d._nowMilliseconds();var l=c&&!e;return e||(e=d._setTimeout(i,b)),l&&!h&&(g=a.apply(j,k)),g};return i.cancel=function(){h=!0},i}function b(){return Date.now()}function c(){return window.setTimeout.apply(window,arguments)}var d={debounce:a,_nowMilliseconds:b,_setTimeout:c};return d}),define("laxar/lib/utilities/storage",["./assert","./configuration"],function(a,b){"use strict";function c(a,b){function c(c){var d=a.getItem(b+"."+c);return d?JSON.parse(d):d}function d(c,d){var e=b+"."+c;void 0===d?a.removeItem(e):a.setItem(e,JSON.stringify(d))}function e(c){a.removeItem(b+"."+c)}return{getItem:c,setItem:d,removeItem:e}}function d(a){var b=window[a];if(b.setItem&&b.getItem&&b.removeItem)try{var c="ax.storage.testItem";return b.setItem(c,1),b.removeItem(c),b}catch(d){}if(window.console){var e="warn"in window.console?"warn":"log";window.console[e]("window."+a+" not available: Using non-persistent polyfill. \nTry disabling private browsing or enabling cookies.")}var f={};return{getItem:function(a){return f[a]||null},setItem:function(a,b){f[a]=b},removeItem:function(a){a in f&&delete f[a]}}}function e(){var a=b.get("storagePrefix");if(a)return a;for(var c=b.get("name",""),d=0,e=c.length-1;e>0;--e)d=(d<<5)-d+c.charCodeAt(e),d|=0;return Math.abs(d)}function f(b,i){var j=b||d(h),k=i||d(g),l="ax."+e()+".";return{getLocalStorage:function(b){return a(b).hasType(String).isNotNull(),c(j,l+b)},getSessionStorage:function(b){return a(b).hasType(String).isNotNull(),c(k,l+b)},getApplicationLocalStorage:function(){return c(j,l+"app")},getApplicationSessionStorage:function(){return c(k,l+"app")},create:f}}var g="sessionStorage",h="localStorage";return f()}),define("laxar/lib/runtime/runtime",["angular","../utilities/assert","../utilities/path","../loaders/paths"],function(a,b,c,d){"use strict";var e=a.module("axRuntime",[]),f={provideQ:function(){b.codeIsUnreachable("Cannot provide q before AngularJS modules have been set up.")}};return e.run(["$rootScope","$window",function(b,c){a.element(c).one("unload",function(){for(;b.$$childHead;)b.$$childHead.$destroy();b.$destroy()})}]),e.run(["axCssLoader","axThemeManager",function(a,b){b.urlProvider(c.join(d.THEMES,"[theme]"),null,[d.DEFAULT_THEME]).provide(["css/theme.css"]).then(function(b){a.load(b[0])})}]),e.run(["$rootScope","axConfiguration",function(a,b){a.i18n={locale:"default",tags:b.get("i18n.locales",{"default":"en"})}}]),e.run(["$q",function(a){f.provideQ=function(){return a}}]),{module:e,api:f}}),define("laxar/lib/loaders/layout_loader",["../utilities/path"],function(a){"use strict";function b(b,c,d,e,f,g){function h(d){var f=a.join(b,d),g=f.substr(f.lastIndexOf("/")+1),h=g+".html",i="css/"+g+".css";return e.urlProvider(a.join(f,"[theme]"),a.join(c,"[theme]","layouts",d)).provide([h,i]).then(function(a){return{html:a[0],css:a[1],className:g.replace(/\//g,"").replace(/_/g,"-")+"-layout"}})}return{load:function(a){return h(a).then(function(a){return a.css&&d.load(a.css),a.html?f.provide(a.html).then(function(b){return a.htmlContent=b,g&&g.put(a.html,b),a}):a})}}}return{create:b}}),define("laxar/lib/runtime/controls_service",["../utilities/path","../utilities/string","../loaders/paths"],function(a,b,c){"use strict";function d(d){function e(c){function d(a){var d=b.format("axControls: "+a,[c,k]);throw new Error(d)}var e=g(c),f=l[e];f||d(i),f._compatibility_0x&&d(j);var h=a.extractScheme(c).ref;return require(a.join(h,f.name))}function f(b){var c=g(b);if(!m[c]){var e=a.join(c,"control.json");m[c]=d.provide(e)["catch"](function(){return{_compatibility_0x:!0,name:b.split("/").pop(),integration:{technology:"angular"}}}).then(function(a){return l[c]=a,a})}return m[c]}function g(b){return a.resolveAssetPath(b,c.CONTROLS)}function h(a){var b=g(a);return l[b]}var i="Tried to load control reference [0] without declaration in widget.json.\nDetails: [1]",j="Cannot use axControls service to load control [0] without descriptor.\nDetails: [1]",k="https://github.com/LaxarJS/laxar/blob/master/docs/manuals/providing_controls.md#compatibility",l={},m={};return{load:f,provide:e,resolve:g,descriptor:h}}return{create:d}}),define("laxar/lib/runtime/theme_manager",["../utilities/assert","../utilities/path"],function(a,b){"use strict";function c(a,b,c){this.q_=b,this.fileResourceProvider_=a,this.theme_=c}function d(a,c,e){return 0===c.length?a.q_.when(null):a.fileResourceProvider_.isAvailable(b.join(c[0],e)).then(function(b){return b?a.q_.when(c[0]):d(a,c.slice(1),e)})}return c.prototype.getTheme=function(){return this.theme_},c.prototype.urlProvider=function(a,c,e){var f=this;return{provide:function(g){var h=[],i=f.theme_+".theme";f.theme_&&"default"!==f.theme_&&(a&&h.push(a.replace("[theme]",i)),c&&h.push(c.replace("[theme]",i))),(e||[]).forEach(function(a){("default"!==f.theme_||-1===a.indexOf("[theme]"))&&h.push(a.replace("[theme]",i))}),a&&h.push(a.replace("[theme]","default.theme"));var j=[];return g.forEach(function(a){j.push(d(f,h,a))}),f.q_.all(j).then(function(a){return a.map(function(a,c){return null!==a?b.join(a,g[c]):null})})}}},{create:function(a,b,d){return new c(a,b,d)}}}),define("laxar/lib/runtime/runtime_services",["angular","../event_bus/event_bus","../i18n/i18n","../file_resource_provider/file_resource_provider","../logging/log","../utilities/object","../utilities/path","../loaders/layout_loader","../loaders/paths","../utilities/configuration","./controls_service","./theme_manager"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(b,c){e.error("EventBus: "+b),c&&a.forEach(c,function(a,b){var c="   - [0]: [1:%o]";-1!==q.indexOf(b)&&(c="   - [0]: [1:%o:anonymize]"),e.error(c,b,a),a instanceof Error&&a.stack&&e.error("   - Stacktrace: "+a.stack)})}var n,o=a.module("axRuntimeServices",[]);o.config(["$qProvider","$httpProvider",function(a,b){n=a,j.get(p)&&b.interceptors.push("axLogHttpInterceptor")}]),o.factory("axHeartbeat",["$window","$rootScope","axPageService",function(a,b,c){function d(d){h||(h=!0,a.setTimeout(function(){for(;j.length;)j.shift()();do{for(;g.length;)g.shift()();i=!1;var a=c.controller();a&&a.applyViewChanges(),i||b.$apply()}while(g.length);for(;k.length;)k.shift()();h=!1},0)),g.push(d)}function e(a){j.push(a)}function f(a){k.push(a)}var g=[],h=!1,i=!1;b.$watch(function(){i=!0});var j=[],k=[];return{onBeforeNext:e,onNext:d,onAfterNext:f}}]),o.factory("axTimestamp",function(){return function(){return(new Date).getTime()}}),o.factory("axControls",["axFileResourceProvider",function(a){return k.create(a)}]),o.factory("axGlobalEventBus",["$injector","$window","axHeartbeat","axConfiguration",function(a,c,d,e){var f=a.invoke(n.$get,n,{$rootScope:{$evalAsync:d.onNext}});b.init(f,d.onNext,function(a,b){c.setTimeout(a,b)});var g=b.create({pendingDidTimeout:e.get("eventBusTimeoutMs",12e4)});return g.setErrorHandler(m),g}]),o.factory("axConfiguration",[function(){return j}]),o.factory("axI18n",[function(){return c}]),o.factory("axFileResourceProvider",["$q","$http","axConfiguration",function(b,c,e){d.init(b,c);var f=d.create(i.PRODUCT),g=e.get("fileListings");return g&&a.forEach(g,function(a,b){"string"==typeof a?f.setFileListingUri(b,a):f.setFileListingContents(b,a)}),f}]),o.factory("axThemeManager",["$q","axConfiguration","axFileResourceProvider",function(a,b,c){var d=b.get("theme"),e=l.create(c,a,d);return{getTheme:e.getTheme.bind(e),urlProvider:e.urlProvider.bind(e)}}]),o.factory("axLayoutLoader",["$templateCache","axCssLoader","axThemeManager","axFileResourceProvider",function(a,b,c,d){return h.create(i.LAYOUTS,i.THEMES,b,c,d,a)}]),o.factory("axCssLoader",["axConfiguration","axThemeManager",function(b,c){function d(){if("boolean"!=typeof d.result&&(d.result=!1,document.createStyleSheet)){var a=navigator.userAgent.match(/MSIE ?(\d+(\.\d+)?)[^\d]/i);(!a||parseFloat(a[1])<10)&&(d.result=!0)}return d.result}function e(b,c){var d=document.createElement(b);a.forEach(c,function(a,b){d[b]=a}),document.getElementsByTagName("head")[0].appendChild(d)}var f=[].some.call(document.getElementsByTagName("link"),function(a){return a.hasAttribute("data-ax-merged-css")});if(f)return{load:function(){}};var h=[],j={load:function(a){if(-1===h.indexOf(a)){if(d()){var b="cssLoaderStyleSheet"+Math.floor(h.length/30);document.getElementById(b)||e("style",{type:"text/css",id:b}),document.getElementById(b).styleSheet.addImport(a)}else e("link",{type:"text/css",id:"cssLoaderStyleSheet"+h.length,rel:"stylesheet",href:a});h.push(a)}}};return b.get("useMergedCss",!1)?(j.load(g.join(i.PRODUCT,"var/static/css",c.getTheme()+".theme.css")),{load:function(){}}):j}]),o.factory("axVisibilityService",["axHeartbeat","$rootScope",function(a,b){function c(a){function c(){return h(d),j}var d=a.$id;a.$on("$destroy",c);for(var f=a;!(f===b||f.widget&&f.widget.area);)f=f.$parent;var i=f.widget&&f.widget.area;if(!i)throw new Error("axVisibilityService: could not determine widget area for scope: "+d);var j={isVisible:function(){return e(i)},onChange:function(a){return g(d,i,a,!0),g(d,i,a,!1),j},onShow:function(a){return g(d,i,a,!0),j},onHide:function(a){return g(d,i,a,!1),j},clear:c};return j}function d(){i={},j={},k={},l={}}function e(a){return i[a]||!1}function f(b,c){i[b]!==c&&(i[b]=c,a.onAfterNext(function(){var a=(c?j:k)[b];if(a)for(var d=a.length-1;d>=0;--d){var e=a[d];null===e.handler?a.splice(d,1):e.handler(c)}}))}function g(a,b,c,d){var e={handler:c};l[a]=l[a]||[],l[a].push(e);var f=d?j:k;f[b]=f[b]||[],f[b].push(e),b in i&&i[b]===d&&c(d)}function h(a){l[a]&&l[a].forEach(function(a){a.handler=null})}var i,j,k,l;return{isVisible:e,handlerFor:c,_updateState:f,_reset:d}}]),o.factory("axLogHttpInterceptor",["axConfiguration",function(b){var c=b.get(p,null);return c?{request:function(b){var d="";return a.forEach(e.gatherTags(),function(a,b){d+="["+b+":"+a+"]"}),d&&(b.headers[c]&&e.warn('axLogHttpInterceptor: Overwriting existing header "[0]"',c),b.headers[c]=d),b}}:{}}]);var p="logging.http.header";o.provider("$exceptionHandler",function(){var a=function(a,b){var c=a.message||a;e.error("There was an exception: "+c+", \nstack: "),e.error(a.stack+", \n"),e.error("  Cause: "+b)};this.$get=[function(){return a}]});var q=["Published event"];return o}),define("laxar/lib/utilities/timer",["./object","./storage","../logging/log"],function(a,b,c){"use strict";function d(b){this.options_=a.options(b,{label:"timer"+i++,persistenceKey:null}),this.startTime_=null,this.stopTime_=null,this.splitTimes_=[]}function e(){return(new Date).getTime()}function f(a){a.options_.persistenceKey&&j.setItem(a.options_.persistenceKey,{options:a.options_,startTime:a.startTime_,stopTime:a.stopTime_,splitTimes:a.splitTimes_})}function g(a){if(a.options_.persistenceKey){var b=j.getItem(a.options_.persistenceKey);if(b)return a.options_=b.options,a.startTime_=b.startTime,a.stopTime_=b.stopTime,a.splitTimes_=b.splitTimes,!0}return!1}function h(a){a.options_.persistenceKey&&j.removeItem(a.options_.persistenceKey)}var i=0,j=b.getSessionStorage("timer");return d.prototype.getData=function(){return{label:this.options_.label,startTime:this.startTime_,stopTime:this.stopTime_,splitTimes:a.deepClone(this.splitTimes_)}},d.prototype.start=function(){this.startTime_=e(),f(this)},d.prototype.splitTime=function(a){this.splitTimes_.push({time:e(),label:a||"split"+this.splitTimes_.length}),f(this)},d.prototype.stop=function(){this.stopTime_=e(),h(this)},d.prototype.stopAndLog=function(a){this.stop();var b=this.startTime_,d=e(),f=a||"Timer Stopped";this.splitTimes_.push({label:f,time:d});var g=[];g.push('Timer "',this.options_.label,'": '),g.push("start at ",new Date(b).toISOString()," (client), "),g.push(f," after ",(d-b).toFixed(0),"ms "),g.push("(checkpoints: ");var h=[];this.splitTimes_.reduce(function(a,b){return h.push('"'+b.label+'"='+(b.time-a).toFixed(0)+"ms"),b.time},b),g.push(h.join(", "),")"),c.info(g.join(""))},{started:function(a){var b=new d(a);return b.start(),b},resumedOrStarted:function(a){var b=new d(a);return g(b)||b.start(),b}}}),define("json!laxar/static/schemas/flow.json",function(){return{$schema:"http://json-schema.org/draft-04/schema#",type:"object",required:["places"],properties:{places:{type:"object",description:"The places for this flow.",patternProperties:{"[a-z][a-zA-Z0-9_]*":{type:"object",properties:{redirectTo:{type:"string",description:"The place to redirect to when hitting this place."},page:{type:"string",description:"The page to render for this place."},targets:{type:"object",patternProperties:{"[a-z][a-zA-Z0-9_]*":{type:"string"}},description:"A map of symbolic targets to places reachable from this place."},entryPoints:{type:"object",patternProperties:{"[a-z][a-zA-Z0-9_]*":{type:"string"}},description:"Entry points defined by this place."},exitPoint:{type:"string",description:"The exit point to invoke when reaching this place."}},additionalProperties:!1}},additionalProperties:!1}},additionalProperties:!1}}),define("laxar/lib/runtime/flow",["angular","angular-route","../logging/log","../json/validator","../utilities/object","../utilities/timer","../utilities/path","../loaders/paths","json!../../static/schemas/flow.json"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(b,c){var d={};return a.forEach(c.expectedParameters,function(a){d[a]=m(b[a])}),d}function k(a,b){var d=e.path(b,"targets."+a,a);return d in y?d:void c.error('Unknown target or place "[0]".',a)}function l(a){return null==a?"_":"string"==typeof a?a.replace(/\//g,"%2F"):a}function m(a){return null==a||""===a||"_"===a?null:"string"==typeof a?a.replace(/%2F/g,"/"):a}function n(a){return r(a).then(function(a){y=q(a),e.forEach(y,function(a,b){o(b,a)}),t.otherwise({redirectTo:"/entry"})})}function o(a,b){return b.redirectTo?void t.when("/"+a,{redirectTo:b.redirectTo}):b.entryPoints?void t.when("/"+a,{redirectTo:p(b.entryPoints)}):b.page||b.exitPoint?void t.when("/"+a,{template:"<!---->",controller:"AxFlowController",resolve:{place:function(){return b}}}):void c.warn("flow: invalid empty place: [0]",b.id)}function p(a){var b=x||{target:"default",parameters:{}},c=a[b.target];if(c){var d=y[c],f=c,g=b.parameters||{};return e.forEach(d.expectedParameters,function(a){f+="/"+l(g[a])}),f}}function q(a){var b={};return e.forEach(a,function(a,c){a.expectedParameters=[],a.id=c,a.targets||(a.targets={}),a.targets[C]||(a.targets[C]=c.split(/\/:/)[0]);for(var d;d=J.exec(c);){var e=c.substr(0,d.index);a.expectedParameters.push(d[1]),b[e]=a}b[c]=a}),b}function r(a){return v.provide(a).then(function(a){return s(a),a.places},function(b){throw new Error('Failed to load "'+a+'". Cause: '+b)})}function s(a){var b=d.create(i).validate(a);if(b.errors.length)throw b.errors.forEach(function(a){c.error("[0]",a.message)}),new Error("Illegal flow.json format")}var t,u=a.module("axFlow",["ngRoute"]);u.config(["$routeProvider",function(a){t=a}]);var v,w,x;u.run(["$route","axConfiguration","axFileResourceProvider",function(a,b,c){v=c,x=b.get("flow.entryPoint"),w=b.get("flow.exitPoints"),n(g.normalize(h.FLOW_JSON)).then(function(){a.reload()})}]);var y,z,A,B="navigationTimer",C="_self",D=C,E=null,F={},G=!1,H={sender:"AxFlowController"},I={subscriber:"AxFlowController"};u.controller("AxFlowController",["$window","$location","$routeParams","place","axGlobalEventBus","axFlowService","axPageService",function(a,b,d,g,h,i,l){function m(a,c){if(!G){G=!0,D=a.target;var d=k(D,g),e=y[d];A=f.started({label:["navigation (",g?g.targets._self:""," -> ",e.targets._self,")"].join(""),persistenceKey:B});var h=i.constructPath(a.target,a.data);h!==b.path()?(b.path(h),c.unsubscribe()):G=!1}}function n(a,b){return h.subscribe("navigateRequest",m,I),c.setTag("PLCE",g.id),z&&h.unsubscribe(z),z=m,G=!1,h.publish("didNavigate."+a,b,H)}z&&(h.unsubscribe(z),z=null);var o=E;if(E=g,F=j(d,g),"string"==typeof g.exitPoint){var p=g.exitPoint;if(w&&"function"==typeof w[p])return void w[p](F);throw new Error('Exitpoint "'+p+'" does not exist.')}G=!0;var q={target:D},r=e.options({data:{},place:g.id
},q);h.publish("willNavigate."+D,q,H).then(function(){return r.data=F,g===o?n(D,r):l.controller().tearDownPage().then(function(){return A=f.resumedOrStarted({label:["loadTimer (",g.target?g.target._self:g.id,")"].join(""),persistenceKey:B}),l.controller().setupPage(g.page)}).then(function(){return n(D,r)}).then(function(){A.stopAndLog("didNavigate")})}).then(null,function(a){c.error(a)})}]),u.factory("axFlowService",["$location",function(a){var b={constructPath:function(a,b){var c=e.options(b,F||{}),d=k(a,E),f=y[d],g="/"+d;return e.forEach(f.expectedParameters,function(a){g+="/"+l(c[a])}),g},constructAnchor:function(a,c){return"#"+b.constructPath(a,c)},constructAbsoluteUrl:function(c,d){var e=a.absUrl().split("#")[0];return e+b.constructAnchor(c,d)},place:function(){return e.deepClone(E)}};return b}]);var J=/\/:([^\/]+)/gi;return u}),define("json!laxar/static/schemas/page.json",function(){return{$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{layout:{type:"string",description:"The layout to use. May be omitted if another page in the extension hierarchy defines one."},"extends":{type:"string",description:"The name of the page to extend."},areas:{type:"object",description:"A map from area name to a list of widgets to display within that area.",patternProperties:{"^[a-z][\\.a-zA-Z0-9_]*$":{type:"array",items:{type:"object",properties:{widget:{type:"string",description:"Path to the widget that should be rendered."},composition:{type:"string",description:"Path to the composition that should be included."},layout:{type:"string",description:"Path to the layout that should be inserted."},id:{type:"string",pattern:"^[a-z][a-zA-Z0-9_]*$",description:"ID of the widget or composition. Will be generated if missing."},insertBeforeId:{type:"string",description:"The ID of the widget this widget or composition should be inserted before."},features:{type:"object",description:"Configuration of the features defined by the widget or composition."},enabled:{type:"boolean","default":!0,description:"Set to false to omit widgets e.g. for debugging purposes."}},additionalProperties:!1}}},additionalProperties:!1}},additionalProperties:!1}}),define("laxar/lib/loaders/page_loader",["../utilities/assert","../utilities/object","../utilities/string","../utilities/path","../json/validator","./features_provider","json!../../static/schemas/page.json","../tooling/pages"],function(a,b,c,d,e,f,g,h){"use strict";function i(a,b,c,d){this.q_=a,this.httpClient_=b,this.baseUrl_=c,this.fileResourceProvider_=d,this.idCounter_=0}function j(a,b,c){var d,e=v(a.baseUrl_,b);return-1!==c.indexOf(b)&&C({name:b},"Cycle in page extension detected: "+c.concat([b]).join(" -> ")),x(a,e).then(function(a){t(a,b),d=a,d.name=b.replace(H,""),d.selfLink=e,d.areas||(d.areas={})},function(){C({name:b},'Page could not be found at location "'+e+'"')}).then(function(){return k(a,d,c)}).then(function(){return m(a,d,b)}).then(function(){return s(a,d)}).then(function(){return h.setPageDefinition(b,d,h.FLAT),d})}function k(a,b,c){return w(b,"extends")?j(a,b["extends"],c.concat([b.name])).then(function(a){l(b,a)}):void 0}function l(a,d){var e=a.areas,f=b.deepClone(d.areas);w(d,"layout")&&(w(a,"layout")&&C(a,c.format('Page overwrites layout set by base page "[name]',d)),a.layout=d.layout),b.forEach(e,function(b,c){return c in f?void u(f[c],b,a):void(f[c]=b)}),a.areas=f}function m(a,c,d){function e(f,g,i){var j=a.q_.when(),k={};return b.forEach(f.areas,function(b){for(var g=b.length-1;g>=0;--g)!function(g,l){if(g.enabled!==!1)if(w(g,"widget")){if(!w(g,"id")){var m=g.widget.split("/").pop();g.id=y(a,m.replace(D,z))}}else if(w(g,"composition")){var q=g.composition;if(-1!==i.indexOf(q)){var r="Cycle in compositions detected: "+i.concat([q]).join(" -> ");C(c,r)}if(!w(g,"id")){var s=g.composition.replace(D,z);g.id=y(a,s)}g.id in k?k[g.id]++:k[g.id]=1,j=j.then(function(){return x(a,v(a.baseUrl_,q))}).then(function(a){return o(a,g)}).then(function(a){return p(a,g,C.bind(null,c))}).then(function(a){var b=i.concat(q);return e(a,g.id,b).then(function(){return h.setCompositionDefinition(d,g.id,a,h.FLAT),a})}).then(function(a){n(a,f,b,l)})}}(b[g],g)}),f===c?h.setPageDefinition(d,f,h.COMPACT):h.setCompositionDefinition(d,g,f,h.COMPACT),r(f,k),j}return e(c,null,[])}function n(a,c,d,e){b.forEach(a.areas,function(a,b){return"."===b?void B(d,e,a):b in c.areas?void u(c.areas[b],a,c):void(c.areas[b]=a)})}function o(a,c){var d={};return b.forEach(a.areas,function(a,b){return a.forEach(function(a){w(a,"id")&&(a.id=c.id+E+a.id)}),b.indexOf(".")>0?void(d[c.id+E+b]=a):void(d[b]=a)}),a.areas=d,a}function p(a,c,d){function e(a){var d=a.match(I);if(!d)return a;var e,f=d[1],h=d[2];return e=0===h.indexOf(J)?A(c.id)+G+h.substr(J.length):b.path(g,h),"string"==typeof e&&f?f+e:e}var g={};if(a.features=q(a.features||{},e),g.features=f.featuresForWidget(a,c,d),"object"==typeof a.mergedFeatures){var h=q(a.mergedFeatures,e);Object.keys(h).forEach(function(a){var c=b.path(g.features,a,[]),d=h[a];b.setPath(g.features,a,d.concat(c))})}return a.areas=q(a.areas,e),a}function q(a,c){if(null===a)return a;if(Array.isArray(a))return a.map(function(a){return"object"==typeof a?q(a,c):"string"==typeof a?c(a):a}).filter(function(a){return"undefined"!=typeof a});var d={};return b.forEach(a,function(a,b){var e=c(b);if("object"==typeof a)return void(d[e]=q(a,c));var f="string"==typeof a?c(a):a;"undefined"!=typeof f&&(d[e]=f)}),d}function r(a,b){var c=Object.keys(b).filter(function(a){return b[a]>1});c.length&&C(a,"Duplicate composition ID(s): "+c.join(", "))}function s(a,c){var d={};b.forEach(c.areas,function(a,b){c.areas[b]=a.filter(function(a){return a.enabled===!1?!1:(d[a.id]=d[a.id]?d[a.id]+1:1,!0)})});var e=Object.keys(d).filter(function(a){return d[a]>1});e.length&&C(c,"Duplicate widget ID(s): "+e.join(", "))}function t(a,b){var c=e.create(g).validate(a);if(c.errors.length){var d=c.errors.reduce(function(a,b){return a+"\n - "+b.message},"");C({name:b},"Schema validation failed: "+d)}}function u(a,b,d){b.forEach(function(b){if(b.insertBeforeId){for(var e=0,f=a.length;f>e;++e)if(a[e].id===b.insertBeforeId)return void a.splice(e,0,b);C(d,c.format('No id found that matches insertBeforeId value "[insertBeforeId]"',b))}a.push(b)})}function v(a,b){return b.match(H)||(b+=".json"),d.join(a,b)}function w(a,b){return"string"==typeof a[b]&&a[b].length}function x(a,b){return a.fileResourceProvider_?a.fileResourceProvider_.provide(b):a.httpClient_.get(b).then(function(a){return a.data})}function y(a,b){return b+E+"id"+a.idCounter_++}function z(a){return a.charAt(1).toUpperCase()}function A(a){return a.replace(F,G).replace(D,z)}function B(a,b,c){a.splice.apply(a,[b,1].concat(c))}function C(a,b){var d=c.format('Error loading page "[name]": [0]',[b],a);throw new Error(d)}var D=/[_\/-]./g,E="-",F=/\-/g,G="+",H=/\.json$/,I=/^(!?)\$\{([^}]+)\}$/,J="topic:";return i.prototype.loadPage=function(a){return j(this,a,[])},{create:function(b,c,d,e){return a(b).isNotNull(),null===e&&a(c).isNotNull(),a(d).isNotNull(),new i(b,c,d,e)}}}),define("laxar/lib/runtime/layout_widget_adapter",["angular"],function(a){"use strict";function b(a,b){function e(){}function f(e,f){j=d.$new(),j.widget=b;var g=document.createElement("div");g.id=b.id,g.className=a.className,g.innerHTML=f,i=c(g)(j),e.appendChild(g)}function g(){i.remove()}function h(){j&&j.$destroy(),j=null}var i,j,k={createController:e,domAttachTo:f,domDetach:g,destroy:h};return k}var c,d,e=a.module("axLayoutWidgetAdapter",[]).run(["$compile","$rootScope",function(a,b){c=a,d=b}]);return{create:b,name:e.name}}),define("laxar/lib/runtime/area_helper",["angular"],function(a){"use strict";function b(b,c,d){function e(a,b){b&&m&&k(a),d._updateState(a,b)}function f(a){return q[a]}function g(a){return r[a]}function h(a,b){if(a in n)throw new Error('The area "'+a+'" is defined twice in the current layout.');return n[a]=b,m&&d.isVisible(a)&&k(a),function(){delete n[a]}}function i(a){return a in n}function j(b){m=!0,b.forEach(function(a){var b=p[a.id];o[b]=o[b]||[],o[b].push(a)}),a.forEach(c.areas,function(a,b){d.isVisible(b)&&k(b)})}function k(c){var d=o[c];if(d&&d.length){var e=n[c];e&&(b.all(d.map(function(a){return a.templatePromise})).then(function(b){var c=e.lastChild;c&&a.element(c).removeClass("last");var f=e.firstChild;if(d.forEach(function(a,c){a.adapter.domAttachTo(e,b[c])}),!f){var g=e.firstChild;g&&(g.className+=" first")}var h=e.lastChild;h&&(h.className+=" last")}),delete o[c])}}var l={setVisibility:e,areasInArea:f,areasInWidget:g,register:h,exists:i,attachWidgets:j};d._reset();var m=!1,n={},o={},p={};a.forEach(c.areas,function(a,b){a.forEach(function(a){p[a.id]=b})});var q={},r={};return a.forEach(c.areas,function(a,b){var c="";if(-1!==b.indexOf(".")){var d=b.split(".")[0];r[d]=r[d]||[],r[d].push(b),c=p[d]}q[c]=q[c]||[],q[c].push(b)}),l}return b}),define("laxar/lib/runtime/locale_event_manager",["../utilities/object"],function(a){"use strict";function b(b,e,f){function g(a){l[a.locale]=a.languageTag,m&&h(a.locale)}function h(a){var b={locale:a,languageTag:l[a]};return e.publish("didChangeLocale."+a,b,c)}function i(){return m=!0,b.all(Object.keys(o).map(h))}function j(){e.unsubscribe(g)}function k(){l=a.deepClone(o),m=!1,e.subscribe("changeLocaleRequest",g,d)}var l,m,n={initialize:i,subscribe:k,unsubscribe:j},o=f.get("i18n.locales",{"default":"en"});return n}var c={sender:"AxPageController"},d={subscriber:"AxPageController"};return b}),define("laxar/lib/runtime/visibility_event_manager",[],function(){"use strict";function a(a,d){function e(a){o=a}function f(){d.subscribe("changeWidgetVisibilityRequest",g,c),d.subscribe("changeAreaVisibilityRequest",h,c),m(q,!0)}function g(c){var e=o.areasInWidget(c.widget),f=["willChangeWidgetVisibility",c.widget,c.visible].join("."),g=["didChangeWidgetVisibility",c.widget,c.visible].join(".");d.publish(f,c,b),a.all((e||[]).map(c.visible?i:j)).then(function(){d.publish(g,c,b)})}function h(a){return l(a.area,a.visible)}function i(a){return k(a,!0)}function j(a){return k(a,!1)}function k(a,c){var e=["changeAreaVisibilityRequest",a].join("."),f={area:a,visible:c};return d.publishAndGatherReplies(e,f,b).then(function(b){if(0===b.length)return l(a,c);var d=b[0];return m(a,d.event.visible)})}function l(a,c){var e=["willChangeAreaVisibility",a,c].join("."),f={area:a,visible:c};d.publish(e,f,b).then(function(){return m(a,c)}).then(function(){var e=["didChangeAreaVisibility",a,c].join(".");return d.publish(e,f,b)})}function m(b,c){o.setVisibility(b,c);var d=o.areasInArea(b);return d?a.all(d.map(c?i:j)):a.when()}function n(){d.unsubscribe(h),d.unsubscribe(g)}var o,p={initialize:f,setAreaHelper:e,unsubscribe:n},q="";return p}var b={sender:"AxPageController",deliverToSender:!1},c={subscriber:"AxPageController"};return a}),define("laxar/lib/runtime/page",["angular","../utilities/assert","../directives/layout/layout","../loaders/page_loader","../loaders/widget_loader","../loaders/paths","./layout_widget_adapter","./flow","./area_helper","./locale_event_manager","./visibility_event_manager","../tooling/pages"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m=a.module("axPage",[c.name,g.name,h.name]),n=5;return m.service("axPageService",[function(){var a;return{controller:function(){return a},registerPageController:function(b){return a=b,function(){a=null}},controllerForScope:function(b){return a}}}]),function(){var c=["$scope","$q","$timeout","axPageService"],h=["axConfiguration","axControls","axCssLoader","axFileResourceProvider","axFlowService","axGlobalEventBus","axHeartbeat","axI18n","axLayoutLoader","axThemeManager","axTimestamp","axVisibilityService"],o=c.concat(h).concat(function(m,o,p,q){function r(b){var c=[];return a.forEach(b.areas,function(a,b){a.forEach(function(a){a.area=b,c.push(a)})}),c}function s(){return F.publishAndGatherReplies("beginLifecycleRequest.default",P,Q)}function t(){return F.publish("didChangeTheme."+M,{theme:M},Q)}function u(a){var b=e.create(o,z),c=o.defer(),d=J.loadPage(a).then(function(a){B=i(o,a,C),O.setAreaHelper(B),I.areas=B,E.load(a.layout).then(c.resolve),N.subscribe();var d=r(a);return o.all(d.map(function(a){return"layout"in a?x(a):b.load(a)}))}).then(function(b){l.setCurrentPage(a),b.forEach(function(a){"function"==typeof a.applyViewChanges&&-1===L.indexOf(a.applyViewChanges)&&L.push(a.applyViewChanges)}),K=b}).then(N.initialize).then(t).then(s).then(O.initialize),f=c.promise.then(function(a){R(a)}),g=d.then(function(){return p(function(){},n,!1)});return o.all([f,g]).then(function(){B.attachWidgets(K)})}function v(){return O.unsubscribe(),N.unsubscribe(),F.publishAndGatherReplies("endLifecycleRequest.default",P,Q).then(function(){K.forEach(function(a){a.destroy()}),K=[],L=[]})}function w(a){R=a}function x(a){return E.load(a.layout).then(function(b){var c=g.create(b,{area:a.area,id:a.id,path:a.layout});return{id:a.id,adapter:c,destroy:c.destroy,templatePromise:o.when(b.htmlContent)}})}function y(){L.forEach(function(a){a()})}var z={},A=[].slice.call(arguments);h.forEach(function(a,b){z[a]=A[c.length+b]});var B,C=z.axVisibilityService,D=z.axConfiguration,E=z.axLayoutLoader,F=z.axGlobalEventBus,G=z.axFileResourceProvider,H=z.axThemeManager,I=this,J=d.create(o,null,f.PAGES,G),K=[],L=[],M=H.getTheme(),N=j(o,F,D),O=k(o,F),P={lifecycleId:"default"},Q={sender:"AxPageController"},R=function(a){b.codeIsUnreachable("No renderer for page layout "+a.className)},S=q.registerPageController(this);m.$on("$destroy",S),this.applyViewChanges=y,this.setupPage=u,this.tearDownPage=v,this.registerLayoutRenderer=w});m.controller("AxPageController",o)}(),m.directive("axPage",["$compile",function(a){var b=[{name:"activities",hidden:!0},{name:"popups"},{name:"popovers"}];return{restrict:"A",template:'<div data-ng-class="layoutClass"></div>',replace:!0,scope:!0,controller:"AxPageController",link:function(c,d,e,f){f.registerLayoutRenderer(function(e){c.layoutClass=e.className,d.html(e.htmlContent),a(d.contents())(c);var g=b.reduce(function(a,b){return f.areas.exists(b.name)?a:a+'<div data-ax-widget-area="'+b.name+'"'+(b.hidden?' style="display: none;"':"")+"></div>"},"");g&&d.append(a(g)(c))})}}}]),m}),define("laxar/lib/profiling/output",["angular"],function(a){"use strict";function b(b,c,j){var k=b.items,l=!!j.match(/^[A-Za-z0-9]{3}$/)&&j in k,m=j,n=[];l?n=k[j].watchers:(m=b.widgetIdToScopeId[j],n=f(Object.keys(k).map(function(a){return k[a]}).filter(function(a){return a.context.widgetId===j}),function(a){return a.watchers}));var o=[].slice.call(i.document.getElementsByClassName("ng-scope"),0).concat([i.document]).map(function(b){return{element:b,scope:a.element(b).scope()}}).filter(function(a){return a.scope.$id===m})[0]||null;g('Showing details for %s with id "%s"',l?"scope":"widget",j),o&&g("Context: Scope: %o, Element %o",o.scope,o.element);var p=n.map(function(a){var b={};if(!c||"watchFn"===c){var f=a.watchFn;b.Watcher=f.name,b["Watcher ms total"]=e(f.time,3),b["Watcher ms average"]=e(d(f.time,f.count),3),b["Watcher # executions"]=f.count}if(!c||"listener"===c){var g=a.listener;b.Listener=g.name,b["Listener ms total"]=e(g.time,3),b["Listener ms average"]=e(d(g.time,g.count),3),b["Listener # executions"]=g.count}return b});h(p)}function c(b,c){var f=b.items,g=[],i=0,j=0,k=0,l=0,m={};a.forEach(f,function(a,b){var c=a.context.widgetId;return c?(c in m||(m[c]={context:a.context,watchers:[]}),void[].push.apply(m[c].watchers,a.watchers)):void(m[b]=a)}),a.forEach(m,function(a){var b=0,f=0,h=0,m=0;a.watchers.forEach(function(a){b+=a[c].time,f+=a[c].count,h+="f"===a[c].type?1:0,m+="s"===a[c].type?1:0},0),g.push({"Widget name":a.context.widgetName||"?","Widget id":a.context.widgetId||"?","Scope id":a.context.widgetScopeId||a.context.scopeId,"# functions":h,"# strings":m,"# total:":h+m,"ms total":e(b,3),"ms average":e(d(b,f),3),"# of executions":f}),i+=h,j+=m,k+=b,l+=f}),g.push({"Widget name":"","Widget id":"","Scope id":"Total:","# functions":i,"# strings":j,"# total:":i+j,"ms total":e(k,3),"ms average":e(d(k,l),3),"# of executions":l}),h(g)}function d(a,b){return b>0?a/b:0}function e(a,b){var c=0===b?1:Math.pow(10,b);return Math.round(a*c)/c}function f(a,b){return Array.prototype.concat.apply([],a.map(b))}function g(a,b){i.console&&i.console.log&&Function.apply.apply(i.console.log,[i.console,arguments])}function h(a){i.console.table?i.console.table(a):g(JSON.stringify(a,null,2))}var i;return{create:function(a){return i=a,{log:g,logForId:b,logAll:c}}}}),define("laxar/lib/profiling/profiling",["angular","./output"],function(a,b){"use strict";function c(a,b,c,h){var i="function"==typeof b,l="function"==typeof c,m=j.items,n=f(a);a.$id in m||(m[a.$id]={context:n,watchers:[]},a.$on("$destroy",function(){d(a),delete m[a.$id]})),n.widgetScopeId&&(n.widgetId in j.widgetIdToScopeId||(j.widgetIdToScopeId[n.widgetId]=n.widgetScopeId));var o={watchFn:{type:i?"f":"s",name:i?g(b)+"()":b,time:0,count:0},listener:{type:l?"f":"s",name:l?g(c)+"()":c,time:0,count:0}};m[a.$id].watchers.push(o);var p=k.call(a,b,c,h),q=a.$$watchers[0];return q.get=e(q.get,o.watchFn),q.fn=e(q.fn,o.listener),function(){p(),d(a)}}function d(a){delete j.items[a.$id],Object.keys(j.widgetIdToScopeId).forEach(function(b){j.widgetIdToScopeId[b]===a.$id&&delete j.widgetIdToScopeId[b]})}function e(a,b){return function(){var c=l.performance.now(),d=a.apply(null,arguments),e=l.performance.now()-c;return++b.count,b.time+=e,d}}function f(a){for(var b=a;!b.hasOwnProperty("widget")&&b!==b.$root;)b=b.$parent;var c=!!b.widget;return{widgetName:c?b.widget.path:"",widgetId:c?b.widget.id:"",widgetScopeId:c?b.$id:null,scopeId:a.$id}}function g(a){if(a.name&&"string"==typeof a.name)return a.name;var b=o.exec(a.toString());return b?b[1].trim():"[anonymous]"}function h(){m.log('Available commands:\n\n - help():\n     prints this help\n\n - log( [scopeOrWidgetId] ):\n     If the argument is omitted this is the same as calling\n     logWatchers() first and logListeners() afterwards.\n     Otherwise all listeners and watchers of the widget or scope\n     with the given id are logged in one table\n\n - logWatchers( [scopeOrWidgetId] ):\n     If the argument is omitted the watchers of all scopes belonging to\n     a specific widget or of global scopes are logged.\n     Otherwise more detailed data for the watchers of the given scope\n     or widget are logged.\n\n - logListeners( [scopeOrWidgetId] ):\n     If the argument is omitted the listeners of all scopes belonging to\n     a specific widget or of global scopes are logged.\n     Otherwise more detailed data for the listeners of the given scope\n     or widget are logged.\n\n - reset():\n     Resets all "# of executions" and millisecond data to zero.')}var i,j,k,l,m,n=a.module("axProfiling",[]);n.run(["$rootScope","$window","axConfiguration",function(a,d,e){if(l=d,i=e.get("profiling",{enabled:!1}),m=b.create(d),i.enabled===!0){if(!l.performance||!l.performance.now)return void m.log("Performance api is not available. Profiling is disabled.");m.log("%c!!! Profiling enabled. Application performance will suffer !!!","font-weight: bold; font-size: 1.2em"),m.log('Type "axProfiling.help()" to get a list of available methods');var f=a.constructor.prototype;j=d.axProfiling={items:{},widgetIdToScopeId:{},logWatchers:function(a){a&&"string"==typeof a?m.logForId(j,"watchFn",a):m.logAll(j,"watchFn")},logListeners:function(a){a&&"string"==typeof a?m.logForId(j,"listener",a):m.logAll(j,"listener")},log:function(a){a&&"string"==typeof a?m.logForId(j,null,a):(m.log("All listeners:"),m.logAll(j,"listener"),m.log("All watchers:"),m.logAll(j,"watchFn"))},reset:function(){Object.keys(j.items).forEach(function(a){j.items[a].watchers.forEach(function(a){a.watchFn.time=0,a.watchFn.count=0,a.listener.time=0,a.listener.count=0})})},help:h},k=f.$watch,f.$watch=function(a,b,d){return c(this,a,b,d||!1)}}}]);var o=/^[ ]*function([^\(]*?)\(/;return n}),define("laxar/lib/runtime/runtime_dependencies",["angular","angular-sanitize","./runtime_services","./flow","./page","../directives/directives","../profiling/profiling"],function(a,b,c,d,e,f,g){"use strict";return a.module("axRuntimeDependencies",["ngSanitize",c.name,d.name,e.name,f.id.name,f.widgetArea.name,g.name])}),define("laxar/laxar",["angular","./lib/logging/log","./lib/directives/directives","./lib/event_bus/event_bus","./lib/file_resource_provider/file_resource_provider","./lib/i18n/i18n","./lib/loaders/widget_loader","./lib/utilities/assert","./lib/utilities/configuration","./lib/utilities/fn","./lib/utilities/object","./lib/utilities/path","./lib/utilities/storage","./lib/utilities/string","./lib/runtime/runtime","./lib/runtime/runtime_dependencies","./lib/runtime/controls_service","./lib/runtime/theme_manager","./lib/widget_adapters/adapters","./lib/tooling/pages"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){"use strict";function u(c,d){w(),v(),b.trace("Bootstrapping LaxarJS..."),d&&Array.isArray(d)&&s.addAdapters(d);var e=[o.module.name,p.name];Object.keys(c).forEach(function(a){var d=s.getFor(a);if(!d)return void b.error("Unknown widget technology: [0]",a);var f=d.bootstrap(c[a]);f&&f.name&&e.push(f.name)}),a.element(document).ready(function(){a.bootstrap(document,e)})}function v(){var c={"event_bus.timeout_ms":"eventBusTimeoutMs","file_resource_provider.listings":"fileListings","file_resource_provider.fileListings":"fileListings","file_resource_provider.useEmbedded":"useEmbeddedFileListings","portal.useMergedCss":"useMergedCss","portal.theme":"theme","portal.flow.entryPoint":"flow.entryPoint","portal.flow.exitPoints":"flow.exitPoints"},d=new Function("return this")();a.forEach(c,function(a,c){var e=k.path(d.laxar,c);if(void 0!==e){b.warn('Found deprecated configuration key "[0]". Use "[1]" instead.',c,a);var f=k.path(d.laxar,a);void 0===f&&k.setPath(d.laxar,a,e)}})}function w(){var a="axLogTags.INST",c=m.getApplicationSessionStorage(),d=c.getItem(a);d||(d=""+(new Date).getTime()+Math.floor(100*Math.random()),c.setItem(a,d)),b.addTag("INST",d)}var x={controlsService:q,eventBus:d,fileResourceProvider:e,path:l,themeManager:r,widgetAdapters:s,widgetLoader:g,runtimeDependenciesModule:p,provideQ:function(){return o.api.provideQ()},pages:t};return{assert:h,bootstrap:u,configuration:i,directives:c,fn:j,i18n:f,log:b,object:k,storage:m,string:n,_tooling:x}}),define("laxar",["laxar/laxar"],function(a){return a});
//# sourceMappingURL=laxar.with-deps.min.js.map