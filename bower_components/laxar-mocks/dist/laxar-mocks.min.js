/** Copyright 2015 aixigo AG, Released under the MIT license: http://laxarjs.org/license */
define("laxar-mocks/lib/helpers",["require"],function(a){"use strict";function b(b,c){return new Promise(function(d,e){(c||a)(b,function(){d(Array.prototype.slice.call(arguments,0))},function(a){e(new Error(a))})})}function c(){return{defer:d,all:Promise.all.bind(Promise),resolve:Promise.resolve.bind(Promise),reject:Promise.reject.bind(Promise),when:Promise.resolve.bind(Promise)}}function d(){var a={};return a.promise=new Promise(function(b,c){a.resolve=b,a.reject=c}),a}return{require:b,legacyQ:c}}),define("laxar-mocks/lib/mini_http",["laxar"],function(a){"use strict";function b(a,b){var c=b||{},e=new XMLHttpRequest;return a in d?d[a]:(d[a]=new Promise(function(b,d){e.onreadystatechange=function(){try{4===e.readyState&&(e.status>=200&&e.status<=299?b({data:e.responseText,status:e.status}):d({message:"Failed to load file: "+a,data:e.responseText,status:e.status,xhr:e}),e.onreadystatechange=null,e=null)}catch(c){d(c)}},e.open("GET",a,!0),e.setRequestHeader("Cache-Control","no-cache"),Object.keys(c).forEach(function(a){e.setRequestHeader(a,c[a])}),e.send(null)}),d[a])}function c(c,d){var e=a.object.options(d,{Accept:"application/json"});return b(c,e).then(function(a){return JSON.parse(a.data)})}var d={};return{get:b,head:b,getJson:c}}),define("laxar-mocks/lib/widget_spec_initializer",["require","laxar","./helpers","./mini_http"],function(a,b,c,d){"use strict";function e(a,b,c,d){return f(a,d).then(g.bind(null,a,b,c,d))}function f(b,d){var e=k.join(b.absSpecLocation,".."),f=k.relative(a.toUrl("."),e),g=d.name.replace(/(.)([A-Z])/g,"$1-$2").toLowerCase();return i(d).then(function(a){var b=[k.join(f,g)].concat(a);return c.require(b)}).then(function(a){return h(b,a[0],a.slice(1),d.integration.technology)}).then(function(){return{id:"testWidget",widget:k.relative(a.toUrl("laxar-path-widgets"),e)}})}function g(e,f,g,h,i){b._tooling.fileResourceProvider.init(c.legacyQ(),d);var k={load:function(){}},l=b._tooling.path.normalize(a.toUrl("laxar-path-root")),m=b._tooling.fileResourceProvider.create(l);e.options.knownMissingResources.length>0&&j(m,e.options.knownMissingResources);var n=b._tooling.themeManager.create(m,c.legacyQ(),"default");g.featureConfiguration={},g.configure=function(a,c){2===arguments.length?b.object.setPath(g.featureConfiguration,a,b.object.deepClone(c)):g.featureConfiguration=b.object.deepClone(a)},g.load=function(){var a=b.object.options(i,{features:g.featureConfiguration||{}});return b._tooling.widgetLoader.create(c.legacyQ(),{axControls:b._tooling.controlsService.create(m),axFileResourceProvider:m,axThemeManager:n,axCssLoader:k,axGlobalEventBus:e.eventBus}).load(a,{onBeforeControllerCreation:function(a,c){["subscribe","publish","publishAndGatherReplies"].forEach(function(b){spyOn(a.context.eventBus,b).and.callThrough()}),b.object.forEach(c,function(a,b){f[b]=a})}}).then(function(a){return a.templatePromise.then(function(c){g.destroy=a.destroy,g.renderTo=function(d){a.adapter.domAttachTo(d,c);var e=b._tooling.widgetAdapters.getFor(h.integration.technology);e.applyViewChanges&&e.applyViewChanges()}})})}}function h(a,d,e,f){var g=b._tooling.widgetAdapters.getFor(f);return g?c.require(["angular-mocks"]).then(function(c){var h=c[0],i=g.bootstrap([d]);return"angular"===f&&(h.module(b._tooling.runtimeDependenciesModule.name),h.module(i.name),e.forEach(function(a){a.name&&h.module(a.name)})),h.inject(function(c){b._tooling.eventBus.init(c,a.eventBusTick,a.eventBusTick),b._tooling.provideQ=function(){return c}}),g}):(b.log.error("Unknown widget technology: [0]",f),Promise.reject(new Error("Unknown widget technology: "+f)))}function i(b){var c=b.controls||[];return Promise.all(c.map(function(b){return d.getJson(a.toUrl(b+"/control")+".json").then(function(a){return b+"/"+a.name})}))}function j(a,b){function c(a){return b.some(function(b){return b instanceof RegExp?b.test(a):-1!==a.indexOf(""+b)})}var d=a.isAvailable.bind(a),e=a.provide.bind(a);a.isAvailable=function(a){return c(a)?Promise.resolve(!1):d(a)},a.provide=function(a){return c(a)?Promise.reject():e(a)}}var k=b._tooling.path;return{createSetupForWidget:e}}),define("laxar-mocks/lib/jasmine_boot",["laxar"],function(a){"use strict";function b(b){if(b)return c(b);window.jasmine=jasmineRequire.core(jasmineRequire),jasmineRequire.html(jasmine);var d=jasmine.getEnv(),e=jasmineRequire["interface"](jasmine,d);a.object.extend(window,e);var f=new jasmine.QueryString({getWindowLocation:function(){return window.location}}),g=f.getParam("catch");d.catchExceptions("undefined"==typeof g?!0:g);var h=f.getParam("throwFailures");d.throwOnExpectationFailure(h);var i=new jasmine.HtmlReporter({env:d,onRaiseExceptionsClick:function(){f.navigateWithNewParam("catch",!d.catchingExceptions())},onThrowExpectationsClick:function(){f.navigateWithNewParam("throwFailures",!d.throwingExpectationFailures())},addToExistingQueryString:function(a,b){return f.fullStringWithNewParam(a,b)},getContainer:function(){return document.body},createElement:function(){return document.createElement.apply(document,arguments)},createTextNode:function(){return document.createTextNode.apply(document,arguments)},timer:new jasmine.Timer});d.addReporter(e.jsApiReporter),d.addReporter(i);var j=new jasmine.HtmlSpecFilter({filterString:function(){return f.getParam("spec")}});return d.specFilter=function(a){return j.matches(a.getFullName())},window.setTimeout=window.setTimeout,window.setInterval=window.setInterval,window.clearTimeout=window.clearTimeout,window.clearInterval=window.clearInterval,i.initialize(),c(d)}function c(a){return{run:function(){a.execute()},env:a}}return{create:b}}),define("laxar-mocks/laxar-mocks",["require","laxar","./lib/helpers","./lib/widget_spec_initializer","./lib/jasmine_boot","promise-polyfill"],function(a,b,c,d,e){"use strict";function f(a,c){var e=b.object.options(c,{adapter:null,knownMissingResources:[]});e.adapter&&b._tooling.widgetAdapters.addAdapters([e.adapter]);var f=b._tooling.widgetAdapters.getFor(a.integration.technology),g=f.applyViewChanges?f.applyViewChanges:function(){};return function(c){q.eventBus=b._tooling.eventBus.create(),q.eventBus.flush=function(){l(g)},u.then(function(b){return b.eventBusTick=k,b.eventBus=q.eventBus,b.options=e,d.createSetupForWidget(b,q.widget,r,a)})["catch"](m).then(c)}}function g(){r.destroy(),o&&o.parentElement&&(o.parentElement.removeChild(o),o=null)}function h(a){var c=a||{};Object.keys(v).sort(function(a,b){return v[a].AX_SORT_INDEX-v[b].AX_SORT_INDEX}).map(function(a){var d=c[a]||{},e=b.object.extend({},v[a],d);return delete e.AX_SORT_INDEX,{primaryTopic:a,subtopics:e}}).forEach(function(a){Object.keys(a.subtopics).forEach(function(b){var c=a.subtopics[b];c&&q.eventBus.publish(a.primaryTopic+"."+b,c)}),q.eventBus.flush()})}function i(){function a(){d.debounce.waiting.forEach(function(a){a(!0)}),d.debounce.waiting.splice(0)}function c(a){d.debounce.waiting=d.debounce.waiting.filter(function(b){return b.timeout!==a})}var d=b.fn;spyOn(d,"debounce").and.callThrough(),d.debounce.flush=a,d.debounce.waiting=[];var e=0;spyOn(d,"_setTimeout").and.callFake(function(a,b){var f=++e,g=function(b){null!==f&&(c(f),f=null,a(b))};return d.debounce.waiting.push(g),g.timeout=f,f})}function j(a){return a.substr(0,a.lastIndexOf("/"))}function k(a){w.push(a)}function l(a){for(;w.length>0;){var b=w.slice(0);w=[],b.forEach(function(a){a()}),a()}}function m(a){window.console&&window.console.error&&window.console.error(a),jasmine.getEnv().fail(a)}function n(){if("function"==typeof window.setImmediate)Promise._setImmediateFn(window.setImmediate);else if("undefined"!=typeof MessageChannel){var a=new MessageChannel,b={},c=b;a.port1.onmessage=function(){var a=b.next,c=a.task;b=a,c()},Promise._setImmediateFn(function(b){c=c.next={task:b},a.port2.postMessage()})}else{var d=window.setTimeout;Promise._setImmediateFn(function(a){d(a,0)})}}Promise._setImmediateFn&&n();var o,p={configure:function(a,b){if(!r.configure)throw new Error("testing.createSetupForWidget needs to be called prior to configure.");r.configure.apply(r,arguments)},load:function(a){if(!r.load)throw new Error("testing.createSetupForWidget needs to be called prior to load.");if("function"!=typeof a)throw new Error("testing.widget.load needs to be called with a Jasmine done-callback function.");r.load()["catch"](m).then(a)},render:function(){return o&&o.parentElement&&o.parentElement.removeChild(o),o=document.createElement("div"),o.id="widgetContainer",document.body.appendChild(o),r.renderTo(o),o.firstChild}},q={createSetupForWidget:f,widget:p,runSpec:null,eventBus:null,tearDown:g,triggerStartupEvents:h,configureMockDebounce:i},r={},s=b._tooling.path;b._tooling.eventBus.init(c.legacyQ(),k,k);var t,u=new Promise(function(b,d){q.runSpec=function(f,g){f.title&&(document.title=f.title);var h=f.specUrl||j(window.location.href),i=s.relative(a.toUrl("./"),h),k="."===i[0]?"":"./",l=f.tests.map(function(a){return k+s.join(i,a)});t=e.create(g||null),c.require(["angular-mocks"]).then(c.require.bind(null,l,a)).then(function(){b({jasmineEnv:t.env,absSpecLocation:h}),t.run()})["catch"](function(a){window.console&&window.console.error&&window.console.error(a),d(a),t.env.beforeEach(function(){t.env.fail(a)}),t.run()})}}),v=function(){var a=0;return{didChangeLocale:{AX_SORT_INDEX:a++,"default":{locale:"default",languageTag:"en"}},didChangeTheme:{AX_SORT_INDEX:a++,"default":{theme:"default"}},beginLifecycleRequest:{AX_SORT_INDEX:a++,"default":{lifecycleId:"default"}},didChangeAreaVisibility:{AX_SORT_INDEX:a++,"content.true":{area:"content",visible:!0}},didNavigate:{AX_SORT_INDEX:a++,testing:{place:"testing",target:"_self",data:{}}}}}(),w=[];return q}),define("laxar-mocks",["laxar-mocks/laxar-mocks"],function(a){return a});
//# sourceMappingURL=laxar-mocks.min.js.map